function j(t){return typeof t=="function"}function Ke(t){let r=t(n=>{Error.call(n),n.stack=new Error().stack});return r.prototype=Object.create(Error.prototype),r.prototype.constructor=r,r}var vt=Ke(t=>function(r){t(this),this.message=r?`${r.length} errors occurred during unsubscription:
${r.map((n,o)=>`${o+1}) ${n.toString()}`).join(`
  `)}`:"",this.name="UnsubscriptionError",this.errors=r});function Oe(t,e){if(t){let r=t.indexOf(e);0<=r&&t.splice(r,1)}}var ee=class t{constructor(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let e;if(!this.closed){this.closed=!0;let{_parentage:r}=this;if(r)if(this._parentage=null,Array.isArray(r))for(let i of r)i.remove(this);else r.remove(this);let{initialTeardown:n}=this;if(j(n))try{n()}catch(i){e=i instanceof vt?i.errors:[i]}let{_finalizers:o}=this;if(o){this._finalizers=null;for(let i of o)try{In(i)}catch(s){e=e??[],s instanceof vt?e=[...e,...s.errors]:e.push(s)}}if(e)throw new vt(e)}}add(e){var r;if(e&&e!==this)if(this.closed)In(e);else{if(e instanceof t){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=(r=this._finalizers)!==null&&r!==void 0?r:[]).push(e)}}_hasParent(e){let{_parentage:r}=this;return r===e||Array.isArray(r)&&r.includes(e)}_addParent(e){let{_parentage:r}=this;this._parentage=Array.isArray(r)?(r.push(e),r):r?[r,e]:e}_removeParent(e){let{_parentage:r}=this;r===e?this._parentage=null:Array.isArray(r)&&Oe(r,e)}remove(e){let{_finalizers:r}=this;r&&Oe(r,e),e instanceof t&&e._removeParent(this)}};ee.EMPTY=(()=>{let t=new ee;return t.closed=!0,t})();var pr=ee.EMPTY;function gt(t){return t instanceof ee||t&&"closed"in t&&j(t.remove)&&j(t.add)&&j(t.unsubscribe)}function In(t){j(t)?t():t.unsubscribe()}var Q={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1};var De={setTimeout(t,e,...r){let{delegate:n}=De;return n?.setTimeout?n.setTimeout(t,e,...r):setTimeout(t,e,...r)},clearTimeout(t){let{delegate:e}=De;return(e?.clearTimeout||clearTimeout)(t)},delegate:void 0};function xt(t){De.setTimeout(()=>{let{onUnhandledError:e}=Q;if(e)e(t);else throw t})}function Je(){}var Cn=hr("C",void 0,void 0);function Kn(t){return hr("E",void 0,t)}function Dn(t){return hr("N",t,void 0)}function hr(t,e,r){return{kind:t,value:e,error:r}}var Ee=null;function Fe(t){if(Q.useDeprecatedSynchronousErrorHandling){let e=!Ee;if(e&&(Ee={errorThrown:!1,error:null}),t(),e){let{errorThrown:r,error:n}=Ee;if(Ee=null,r)throw n}}else t()}function Fn(t){Q.useDeprecatedSynchronousErrorHandling&&Ee&&(Ee.errorThrown=!0,Ee.error=t)}var ke=class extends ee{constructor(e){super(),this.isStopped=!1,e?(this.destination=e,gt(e)&&e.add(this)):this.destination=oi}static create(e,r,n){return new ie(e,r,n)}next(e){this.isStopped?mr(Dn(e),this):this._next(e)}error(e){this.isStopped?mr(Kn(e),this):(this.isStopped=!0,this._error(e))}complete(){this.isStopped?mr(Cn,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(e){this.destination.next(e)}_error(e){try{this.destination.error(e)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}},ri=Function.prototype.bind;function dr(t,e){return ri.call(t,e)}var yr=class{constructor(e){this.partialObserver=e}next(e){let{partialObserver:r}=this;if(r.next)try{r.next(e)}catch(n){_t(n)}}error(e){let{partialObserver:r}=this;if(r.error)try{r.error(e)}catch(n){_t(n)}else _t(e)}complete(){let{partialObserver:e}=this;if(e.complete)try{e.complete()}catch(r){_t(r)}}},ie=class extends ke{constructor(e,r,n){super();let o;if(j(e)||!e)o={next:e??void 0,error:r??void 0,complete:n??void 0};else{let i;this&&Q.useDeprecatedNextContext?(i=Object.create(e),i.unsubscribe=()=>this.unsubscribe(),o={next:e.next&&dr(e.next,i),error:e.error&&dr(e.error,i),complete:e.complete&&dr(e.complete,i)}):o=e}this.destination=new yr(o)}};function _t(t){Q.useDeprecatedSynchronousErrorHandling?Fn(t):xt(t)}function ni(t){throw t}function mr(t,e){let{onStoppedNotification:r}=Q;r&&De.setTimeout(()=>r(t,e))}var oi={closed:!0,next:Je,error:ni,complete:Je};var Be=typeof Symbol=="function"&&Symbol.observable||"@@observable";function Me(t){return t}function Bn(...t){return br(t)}function br(t){return t.length===0?Me:t.length===1?t[0]:function(r){return t.reduce((n,o)=>o(n),r)}}var N=class t{constructor(e){e&&(this._subscribe=e)}lift(e){let r=new t;return r.source=this,r.operator=e,r}subscribe(e,r,n){let o=si(e)?e:new ie(e,r,n);return Fe(()=>{let{operator:i,source:s}=this;o.add(i?i.call(o,s):s?this._subscribe(o):this._trySubscribe(o))}),o}_trySubscribe(e){try{return this._subscribe(e)}catch(r){e.error(r)}}forEach(e,r){return r=Mn(r),new r((n,o)=>{let i=new ie({next:s=>{try{e(s)}catch(u){o(u),i.unsubscribe()}},error:o,complete:n});this.subscribe(i)})}_subscribe(e){var r;return(r=this.source)===null||r===void 0?void 0:r.subscribe(e)}[Be](){return this}pipe(...e){return br(e)(this)}toPromise(e){return e=Mn(e),new e((r,n)=>{let o;this.subscribe(i=>o=i,i=>n(i),()=>r(o))})}};N.create=t=>new N(t);function Mn(t){var e;return(e=t??Q.Promise)!==null&&e!==void 0?e:Promise}function ii(t){return t&&j(t.next)&&j(t.error)&&j(t.complete)}function si(t){return t&&t instanceof ke||ii(t)&&gt(t)}function ai(t){return j(t?.lift)}function D(t){return e=>{if(ai(e))return e.lift(function(r){try{return t(r,this)}catch(n){this.error(n)}});throw new TypeError("Unable to lift unknown Observable type")}}function B(t,e,r,n,o){return new vr(t,e,r,n,o)}var vr=class extends ke{constructor(e,r,n,o,i,s){super(e),this.onFinalize=i,this.shouldUnsubscribe=s,this._next=r?function(u){try{r(u)}catch(a){e.error(a)}}:super._next,this._error=o?function(u){try{o(u)}catch(a){e.error(a)}finally{this.unsubscribe()}}:super._error,this._complete=n?function(){try{n()}catch(u){e.error(u)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var e;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){let{closed:r}=this;super.unsubscribe(),!r&&((e=this.onFinalize)===null||e===void 0||e.call(this))}}};var Nn=Ke(t=>function(){t(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});var Ne=class extends N{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(e){let r=new wt(this,this);return r.operator=e,r}_throwIfClosed(){if(this.closed)throw new Nn}next(e){Fe(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(let r of this.currentObservers)r.next(e)}})}error(e){Fe(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=e;let{observers:r}=this;for(;r.length;)r.shift().error(e)}})}complete(){Fe(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;let{observers:e}=this;for(;e.length;)e.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var e;return((e=this.observers)===null||e===void 0?void 0:e.length)>0}_trySubscribe(e){return this._throwIfClosed(),super._trySubscribe(e)}_subscribe(e){return this._throwIfClosed(),this._checkFinalizedStatuses(e),this._innerSubscribe(e)}_innerSubscribe(e){let{hasError:r,isStopped:n,observers:o}=this;return r||n?pr:(this.currentObservers=null,o.push(e),new ee(()=>{this.currentObservers=null,Oe(o,e)}))}_checkFinalizedStatuses(e){let{hasError:r,thrownError:n,isStopped:o}=this;r?e.error(n):o&&e.complete()}asObservable(){let e=new N;return e.source=this,e}};Ne.create=(t,e)=>new wt(t,e);var wt=class extends Ne{constructor(e,r){super(),this.destination=e,this.source=r}next(e){var r,n;(n=(r=this.destination)===null||r===void 0?void 0:r.next)===null||n===void 0||n.call(r,e)}error(e){var r,n;(n=(r=this.destination)===null||r===void 0?void 0:r.error)===null||n===void 0||n.call(r,e)}complete(){var e,r;(r=(e=this.destination)===null||e===void 0?void 0:e.complete)===null||r===void 0||r.call(e)}_subscribe(e){var r,n;return(n=(r=this.source)===null||r===void 0?void 0:r.subscribe(e))!==null&&n!==void 0?n:pr}};var Ln=new N(t=>t.complete());function qn(t){return t&&j(t.schedule)}function $n(t){return t[t.length-1]}function Un(t){return j($n(t))?t.pop():void 0}function Wn(t){return qn($n(t))?t.pop():void 0}function Vn(t,e,r,n){function o(i){return i instanceof r?i:new r(function(s){s(i)})}return new(r||(r=Promise))(function(i,s){function u(c){try{l(n.next(c))}catch(f){s(f)}}function a(c){try{l(n.throw(c))}catch(f){s(f)}}function l(c){c.done?i(c.value):o(c.value).then(u,a)}l((n=n.apply(t,e||[])).next())})}function Hn(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Se(t){return this instanceof Se?(this.v=t,this):new Se(t)}function zn(t,e,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=r.apply(t,e||[]),o,i=[];return o=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),u("next"),u("throw"),u("return",s),o[Symbol.asyncIterator]=function(){return this},o;function s(h){return function(v){return Promise.resolve(v).then(h,f)}}function u(h,v){n[h]&&(o[h]=function(d){return new Promise(function(b,m){i.push([h,d,b,m])>1||a(h,d)})},v&&(o[h]=v(o[h])))}function a(h,v){try{l(n[h](v))}catch(d){p(i[0][3],d)}}function l(h){h.value instanceof Se?Promise.resolve(h.value.v).then(c,f):p(i[0][2],h)}function c(h){a("next",h)}function f(h){a("throw",h)}function p(h,v){h(v),i.shift(),i.length&&a(i[0][0],i[0][1])}}function Yn(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],r;return e?e.call(t):(t=typeof Hn=="function"?Hn(t):t[Symbol.iterator](),r={},n("next"),n("throw"),n("return"),r[Symbol.asyncIterator]=function(){return this},r);function n(i){r[i]=t[i]&&function(s){return new Promise(function(u,a){s=t[i](s),o(u,a,s.done,s.value)})}}function o(i,s,u,a){Promise.resolve(a).then(function(l){i({value:l,done:u})},s)}}var Ot=t=>t&&typeof t.length=="number"&&typeof t!="function";function Et(t){return j(t?.then)}function kt(t){return j(t[Be])}function St(t){return Symbol.asyncIterator&&j(t?.[Symbol.asyncIterator])}function Pt(t){return new TypeError(`You provided ${t!==null&&typeof t=="object"?"an invalid object":`'${t}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}function ui(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var Tt=ui();function At(t){return j(t?.[Tt])}function jt(t){return zn(this,arguments,function*(){let r=t.getReader();try{for(;;){let{value:n,done:o}=yield Se(r.read());if(o)return yield Se(void 0);yield yield Se(n)}}finally{r.releaseLock()}})}function Rt(t){return j(t?.getReader)}function U(t){if(t instanceof N)return t;if(t!=null){if(kt(t))return ci(t);if(Ot(t))return li(t);if(Et(t))return fi(t);if(St(t))return Xn(t);if(At(t))return pi(t);if(Rt(t))return hi(t)}throw Pt(t)}function ci(t){return new N(e=>{let r=t[Be]();if(j(r.subscribe))return r.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}function li(t){return new N(e=>{for(let r=0;r<t.length&&!e.closed;r++)e.next(t[r]);e.complete()})}function fi(t){return new N(e=>{t.then(r=>{e.closed||(e.next(r),e.complete())},r=>e.error(r)).then(null,xt)})}function pi(t){return new N(e=>{for(let r of t)if(e.next(r),e.closed)return;e.complete()})}function Xn(t){return new N(e=>{di(t,e).catch(r=>e.error(r))})}function hi(t){return Xn(jt(t))}function di(t,e){var r,n,o,i;return Vn(this,void 0,void 0,function*(){try{for(r=Yn(t);n=yield r.next(),!n.done;){let s=n.value;if(e.next(s),e.closed)return}}catch(s){o={error:s}}finally{try{n&&!n.done&&(i=r.return)&&(yield i.call(r))}finally{if(o)throw o.error}}e.complete()})}function X(t,e,r,n=0,o=!1){let i=e.schedule(function(){r(),o?t.add(this.schedule(null,n)):this.unsubscribe()},n);if(t.add(i),!o)return i}function It(t,e=0){return D((r,n)=>{r.subscribe(B(n,o=>X(n,t,()=>n.next(o),e),()=>X(n,t,()=>n.complete(),e),o=>X(n,t,()=>n.error(o),e)))})}function Ct(t,e=0){return D((r,n)=>{n.add(t.schedule(()=>r.subscribe(n),e))})}function Gn(t,e){return U(t).pipe(Ct(e),It(e))}function Jn(t,e){return U(t).pipe(Ct(e),It(e))}function Qn(t,e){return new N(r=>{let n=0;return e.schedule(function(){n===t.length?r.complete():(r.next(t[n++]),r.closed||this.schedule())})})}function Zn(t,e){return new N(r=>{let n;return X(r,e,()=>{n=t[Tt](),X(r,e,()=>{let o,i;try{({value:o,done:i}=n.next())}catch(s){r.error(s);return}i?r.complete():r.next(o)},0,!0)}),()=>j(n?.return)&&n.return()})}function Kt(t,e){if(!t)throw new Error("Iterable cannot be null");return new N(r=>{X(r,e,()=>{let n=t[Symbol.asyncIterator]();X(r,e,()=>{n.next().then(o=>{o.done?r.complete():r.next(o.value)})},0,!0)})})}function eo(t,e){return Kt(jt(t),e)}function to(t,e){if(t!=null){if(kt(t))return Gn(t,e);if(Ot(t))return Qn(t,e);if(Et(t))return Jn(t,e);if(St(t))return Kt(t,e);if(At(t))return Zn(t,e);if(Rt(t))return eo(t,e)}throw Pt(t)}function de(t,e){return e?to(t,e):U(t)}function gr(...t){let e=Wn(t);return de(t,e)}function te(t,e){return D((r,n)=>{let o=0;r.subscribe(B(n,i=>{n.next(t.call(e,i,o++))}))})}var{isArray:mi}=Array;function yi(t,e){return mi(e)?t(...e):t(e)}function ro(t){return te(e=>yi(t,e))}function oo(t,e,r=Me){return n=>{no(e,()=>{let{length:o}=t,i=new Array(o),s=o,u=o;for(let a=0;a<o;a++)no(e,()=>{let l=de(t[a],e),c=!1;l.subscribe(B(n,f=>{i[a]=f,c||(c=!0,u--),u||n.next(r(i.slice()))},()=>{--s||n.complete()}))},n)},n)}}function no(t,e,r){t?X(r,t,e):e()}function io(t,e,r,n,o,i,s,u){let a=[],l=0,c=0,f=!1,p=()=>{f&&!a.length&&!l&&e.complete()},h=d=>l<n?v(d):a.push(d),v=d=>{i&&e.next(d),l++;let b=!1;U(r(d,c++)).subscribe(B(e,m=>{o?.(m),i?h(m):e.next(m)},()=>{b=!0},void 0,()=>{if(b)try{for(l--;a.length&&l<n;){let m=a.shift();s?X(e,s,()=>v(m)):v(m)}p()}catch(m){e.error(m)}}))};return t.subscribe(B(e,h,()=>{f=!0,p()})),()=>{u?.()}}function Dt(t,e,r=1/0){return j(e)?Dt((n,o)=>te((i,s)=>e(n,i,o,s))(U(t(n,o))),r):(typeof e=="number"&&(r=e),D((n,o)=>io(n,o,t,r)))}var{isArray:bi}=Array;function so(t){return t.length===1&&bi(t[0])?t[0]:t}function xr(t,e){return D((r,n)=>{let o=0;r.subscribe(B(n,i=>t.call(e,i,o++)&&n.next(i)))})}function _r(t,e=null){return e=e??t,D((r,n)=>{let o=[],i=0;r.subscribe(B(n,s=>{let u=null;i++%e===0&&o.push([]);for(let a of o)a.push(s),t<=a.length&&(u=u??[],u.push(a));if(u)for(let a of u)Oe(o,a),n.next(a)},()=>{for(let s of o)n.next(s);n.complete()},void 0,()=>{o=null}))})}function ao(t,e,r,n,o){return(i,s)=>{let u=r,a=e,l=0;i.subscribe(B(s,c=>{let f=l++;a=u?t(a,c,f):(u=!0,c),n&&s.next(a)},o&&(()=>{u&&s.next(a),s.complete()})))}}function uo(t,e){return D(ao(t,e,arguments.length>=2,!1,!0))}function wr(...t){let e=Un(t);return e?Bn(wr(...t),ro(e)):D((r,n)=>{oo([r,...so(t)])(n)})}function Qe(...t){return wr(...t)}function Or(t){return uo((e,r,n)=>!t||t(r,n)?e+1:e,0)}function Er(t){return t<=0?()=>Ln:D((e,r)=>{let n=0;e.subscribe(B(r,o=>{++n<=t&&(r.next(o),t<=n&&r.complete())}))})}function kr(t,e){return D((r,n)=>{let o=new Set;r.subscribe(B(n,i=>{let s=t?t(i):i;o.has(s)||(o.add(s),n.next(i))})),e&&U(e).subscribe(B(n,()=>o.clear(),Je))})}function Pr(t={}){let{connector:e=()=>new Ne,resetOnError:r=!0,resetOnComplete:n=!0,resetOnRefCountZero:o=!0}=t;return i=>{let s,u,a,l=0,c=!1,f=!1,p=()=>{u?.unsubscribe(),u=void 0},h=()=>{p(),s=a=void 0,c=f=!1},v=()=>{let d=s;h(),d?.unsubscribe()};return D((d,b)=>{l++,!f&&!c&&p();let m=a=a??e();b.add(()=>{l--,l===0&&!f&&!c&&(u=Sr(v,o))}),m.subscribe(b),!s&&l>0&&(s=new ie({next:y=>m.next(y),error:y=>{f=!0,p(),u=Sr(h,r,y),m.error(y)},complete:()=>{c=!0,p(),u=Sr(h,n),m.complete()}}),U(d).subscribe(s))})(i)}}function Sr(t,e,...r){if(e===!0){t();return}if(e===!1)return;let n=new ie({next:()=>{n.unsubscribe(),t()}});return U(e(...r)).subscribe(n)}function Ft(t,e){return D((r,n)=>{let o=null,i=0,s=!1,u=()=>s&&!o&&n.complete();r.subscribe(B(n,a=>{o?.unsubscribe();let l=0,c=i++;U(t(a,c)).subscribe(o=B(n,f=>n.next(e?e(a,f,c,l++):f),()=>{o=null,u()}))},()=>{s=!0,u()}))})}function Bt(t,e,r){let n=j(t)||e||r?{next:t,error:e,complete:r}:t;return n?D((o,i)=>{var s;(s=n.subscribe)===null||s===void 0||s.call(n);let u=!0;o.subscribe(B(i,a=>{var l;(l=n.next)===null||l===void 0||l.call(n,a),i.next(a)},()=>{var a;u=!1,(a=n.complete)===null||a===void 0||a.call(n),i.complete()},a=>{var l;u=!1,(l=n.error)===null||l===void 0||l.call(n,a),i.error(a)},()=>{var a,l;u&&((a=n.unsubscribe)===null||a===void 0||a.call(n)),(l=n.finalize)===null||l===void 0||l.call(n)}))}):Me}function Mt(t){switch(t.responseType){case"json":return"response"in t?t.response:JSON.parse(t.responseText);case"document":return t.responseXML;case"text":default:return"response"in t?t.response:t.responseText}}var Nt=class{constructor(e,r,n,o="download_load"){this.originalEvent=e,this.xhr=r,this.request=n,this.type=o;let{status:i,responseType:s}=r;this.status=i??0,this.responseType=s??"";let u=r.getAllResponseHeaders();this.responseHeaders=u?u.split(`
`).reduce((c,f)=>{let p=f.indexOf(": ");return c[f.slice(0,p)]=f.slice(p+2),c},{}):{},this.response=Mt(r);let{loaded:a,total:l}=e;this.loaded=a,this.total=l}};var Ze=Ke(t=>function(r,n,o){this.message=r,this.name="AjaxError",this.xhr=n,this.request=o,this.status=n.status,this.responseType=n.responseType;let i;try{i=Mt(n)}catch{i=n.responseText}this.response=i}),co=(()=>{function t(e,r){return Ze.call(this,"ajax timeout",e,r),this.name="AjaxTimeoutError",this}return t.prototype=Object.create(Ze.prototype),t})();function vi(t,e){return me({method:"GET",url:t,headers:e})}function gi(t,e,r){return me({method:"POST",url:t,body:e,headers:r})}function xi(t,e){return me({method:"DELETE",url:t,headers:e})}function _i(t,e,r){return me({method:"PUT",url:t,body:e,headers:r})}function wi(t,e,r){return me({method:"PATCH",url:t,body:e,headers:r})}var Oi=te(t=>t.response);function Ei(t,e){return Oi(me({method:"GET",url:t,headers:e}))}var me=(()=>{let t=e=>Si(typeof e=="string"?{url:e}:e);return t.get=vi,t.post=gi,t.delete=xi,t.put=_i,t.patch=wi,t.getJSON=Ei,t})(),ki="upload",lo="download",Tr="loadstart",Ar="progress",fo="load";function Si(t){return new N(e=>{var r,n;let o=Object.assign({async:!0,crossDomain:!1,withCredentials:!1,method:"GET",timeout:0,responseType:"json"},t),{queryParams:i,body:s,headers:u}=o,a=o.url;if(!a)throw new TypeError("url is required");if(i){let g;if(a.includes("?")){let E=a.split("?");if(2<E.length)throw new TypeError("invalid url");g=new URLSearchParams(E[1]),new URLSearchParams(i).forEach((O,x)=>g.set(x,O)),a=E[0]+"?"+g}else g=new URLSearchParams(i),a=a+"?"+g}let l={};if(u)for(let g in u)u.hasOwnProperty(g)&&(l[g.toLowerCase()]=u[g]);let c=o.crossDomain;!c&&!("x-requested-with"in l)&&(l["x-requested-with"]="XMLHttpRequest");let{withCredentials:f,xsrfCookieName:p,xsrfHeaderName:h}=o;if((f||!c)&&p&&h){let g=(n=(r=document?.cookie.match(new RegExp(`(^|;\\s*)(${p})=([^;]*)`)))===null||r===void 0?void 0:r.pop())!==null&&n!==void 0?n:"";g&&(l[h]=g)}let v=Pi(s,l),d=Object.assign(Object.assign({},o),{url:a,headers:l,body:v}),b;b=t.createXHR?t.createXHR():new XMLHttpRequest;{let{progressSubscriber:g,includeDownloadProgress:E=!1,includeUploadProgress:O=!1}=t,x=(P,R)=>{b.addEventListener(P,()=>{var I;let C=R();(I=g?.error)===null||I===void 0||I.call(g,C),e.error(C)})};x("timeout",()=>new co(b,d)),x("abort",()=>new Ze("aborted",b,d));let A=(P,R)=>new Nt(R,b,d,`${P}_${R.type}`),w=(P,R,I)=>{P.addEventListener(R,C=>{e.next(A(I,C))})};O&&[Tr,Ar,fo].forEach(P=>w(b.upload,P,ki)),g&&[Tr,Ar].forEach(P=>b.upload.addEventListener(P,R=>{var I;return(I=g?.next)===null||I===void 0?void 0:I.call(g,R)})),E&&[Tr,Ar].forEach(P=>w(b,P,lo));let F=P=>{let R="ajax error"+(P?" "+P:"");e.error(new Ze(R,b,d))};b.addEventListener("error",P=>{var R;(R=g?.error)===null||R===void 0||R.call(g,P),F()}),b.addEventListener(fo,P=>{var R,I;let{status:C}=b;if(C<400){(R=g?.complete)===null||R===void 0||R.call(g);let oe;try{oe=A(lo,P)}catch(he){e.error(he);return}e.next(oe),e.complete()}else(I=g?.error)===null||I===void 0||I.call(g,P),F(C)})}let{user:m,method:y,async:_}=d;m?b.open(y,a,_,m,d.password):b.open(y,a,_),_&&(b.timeout=d.timeout,b.responseType=d.responseType),"withCredentials"in b&&(b.withCredentials=d.withCredentials);for(let g in l)l.hasOwnProperty(g)&&b.setRequestHeader(g,l[g]);return v?b.send(v):b.send(),()=>{b&&b.readyState!==4&&b.abort()}})}function Pi(t,e){var r;if(!t||typeof t=="string"||Ci(t)||Ki(t)||Ai(t)||ji(t)||Ri(t)||Di(t))return t;if(Ii(t))return t.buffer;if(typeof t=="object")return e["content-type"]=(r=e["content-type"])!==null&&r!==void 0?r:"application/json;charset=utf-8",JSON.stringify(t);throw new TypeError("Unknown body type")}var Ti=Object.prototype.toString;function jr(t,e){return Ti.call(t)===`[object ${e}]`}function Ai(t){return jr(t,"ArrayBuffer")}function ji(t){return jr(t,"File")}function Ri(t){return jr(t,"Blob")}function Ii(t){return typeof ArrayBuffer<"u"&&ArrayBuffer.isView(t)}function Ci(t){return typeof FormData<"u"&&t instanceof FormData}function Ki(t){return typeof URLSearchParams<"u"&&t instanceof URLSearchParams}function Di(t){return typeof ReadableStream<"u"&&t instanceof ReadableStream}var M=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,q=Object.keys,H=Array.isArray;function z(t,e){return typeof e!="object"||q(e).forEach(function(r){t[r]=e[r]}),t}typeof Promise>"u"||M.Promise||(M.Promise=Promise);var ut=Object.getPrototypeOf,Fi={}.hasOwnProperty;function J(t,e){return Fi.call(t,e)}function Ve(t,e){typeof e=="function"&&(e=e(ut(t))),(typeof Reflect>"u"?q:Reflect.ownKeys)(e).forEach(r=>{le(t,r,e[r])})}var ko=Object.defineProperty;function le(t,e,r,n){ko(t,e,z(r&&J(r,"get")&&typeof r.get=="function"?{get:r.get,set:r.set,configurable:!0}:{value:r,configurable:!0,writable:!0},n))}function Ue(t){return{from:function(e){return t.prototype=Object.create(e.prototype),le(t.prototype,"constructor",t),{extend:Ve.bind(null,t.prototype)}}}}var Bi=Object.getOwnPropertyDescriptor;function mn(t,e){let r;return Bi(t,e)||(r=ut(t))&&mn(r,e)}var Mi=[].slice;function er(t,e,r){return Mi.call(t,e,r)}function So(t,e){return e(t)}function tt(t){if(!t)throw new Error("Assertion Failed")}function Po(t){M.setImmediate?setImmediate(t):setTimeout(t,0)}function To(t,e){return t.reduce((r,n,o)=>{var i=e(n,o);return i&&(r[i[0]]=i[1]),r},{})}function fe(t,e){if(J(t,e))return t[e];if(!e)return t;if(typeof e!="string"){for(var r=[],n=0,o=e.length;n<o;++n){var i=fe(t,e[n]);r.push(i)}return r}var s=e.indexOf(".");if(s!==-1){var u=t[e.substr(0,s)];return u===void 0?void 0:fe(u,e.substr(s+1))}}function Z(t,e,r){if(t&&e!==void 0&&(!("isFrozen"in Object)||!Object.isFrozen(t)))if(typeof e!="string"&&"length"in e){tt(typeof r!="string"&&"length"in r);for(var n=0,o=e.length;n<o;++n)Z(t,e[n],r[n])}else{var i=e.indexOf(".");if(i!==-1){var s=e.substr(0,i),u=e.substr(i+1);if(u==="")r===void 0?H(t)&&!isNaN(parseInt(s))?t.splice(s,1):delete t[s]:t[s]=r;else{var a=t[s];a&&J(t,s)||(a=t[s]={}),Z(a,u,r)}}else r===void 0?H(t)&&!isNaN(parseInt(e))?t.splice(e,1):delete t[e]:t[e]=r}}function Ao(t){var e={};for(var r in t)J(t,r)&&(e[r]=t[r]);return e}var Ni=[].concat;function jo(t){return Ni.apply([],t)}var Ro="Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(jo([8,16,32,64].map(t=>["Int","Uint","Float"].map(e=>e+t+"Array")))).filter(t=>M[t]),Li=Ro.map(t=>M[t]);To(Ro,t=>[t,!0]);var be=null;function mt(t){be=typeof WeakMap<"u"&&new WeakMap;let e=Mr(t);return be=null,e}function Mr(t){if(!t||typeof t!="object")return t;let e=be&&be.get(t);if(e)return e;if(H(t)){e=[],be&&be.set(t,e);for(var r=0,n=t.length;r<n;++r)e.push(Mr(t[r]))}else if(Li.indexOf(t.constructor)>=0)e=t;else{let i=ut(t);for(var o in e=i===Object.prototype?{}:Object.create(i),be&&be.set(t,e),t)J(t,o)&&(e[o]=Mr(t[o]))}return e}var{toString:qi}={};function Nr(t){return qi.call(t).slice(8,-1)}var Lr=typeof Symbol<"u"?Symbol.iterator:"@@iterator",$i=typeof Lr=="symbol"?function(t){var e;return t!=null&&(e=t[Lr])&&e.apply(t)}:function(){return null},$e={};function ue(t){var e,r,n,o;if(arguments.length===1){if(H(t))return t.slice();if(this===$e&&typeof t=="string")return[t];if(o=$i(t)){for(r=[];!(n=o.next()).done;)r.push(n.value);return r}if(t==null)return[t];if(typeof(e=t.length)=="number"){for(r=new Array(e);e--;)r[e]=t[e];return r}return[t]}for(e=arguments.length,r=new Array(e);e--;)r[e]=arguments[e];return r}var yn=typeof Symbol<"u"?t=>t[Symbol.toStringTag]==="AsyncFunction":()=>!1,ne=typeof location<"u"&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function Io(t,e){ne=t,Co=e}var Co=()=>!0,Ui=!new Error("").stack;function Ce(){if(Ui)try{throw Ce.arguments,new Error}catch(t){return t}return new Error}function qr(t,e){var r=t.stack;return r?(e=e||0,r.indexOf(t.name)===0&&(e+=(t.name+t.message).split(`
`).length),r.split(`
`).slice(e).filter(Co).map(n=>`
`+n).join("")):""}var Ko=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],bn=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"].concat(Ko),Wi={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function We(t,e){this._e=Ce(),this.name=t,this.message=e}function Do(t,e){return t+". Errors: "+Object.keys(e).map(r=>e[r].toString()).filter((r,n,o)=>o.indexOf(r)===n).join(`
`)}function tr(t,e,r,n){this._e=Ce(),this.failures=e,this.failedKeys=n,this.successCount=r,this.message=Do(t,e)}function nt(t,e){this._e=Ce(),this.name="BulkError",this.failures=Object.keys(e).map(r=>e[r]),this.failuresByPos=e,this.message=Do(t,e)}Ue(We).from(Error).extend({stack:{get:function(){return this._stack||(this._stack=this.name+": "+this.message+qr(this._e,2))}},toString:function(){return this.name+": "+this.message}}),Ue(tr).from(We),Ue(nt).from(We);var vn=bn.reduce((t,e)=>(t[e]=e+"Error",t),{}),Hi=We,T=bn.reduce((t,e)=>{var r=e+"Error";function n(o,i){this._e=Ce(),this.name=r,o?typeof o=="string"?(this.message=`${o}${i?`
 `+i:""}`,this.inner=i||null):typeof o=="object"&&(this.message=`${o.name} ${o.message}`,this.inner=o):(this.message=Wi[e]||r,this.inner=null)}return Ue(n).from(Hi),t[e]=n,t},{});T.Syntax=SyntaxError,T.Type=TypeError,T.Range=RangeError;var po=Ko.reduce((t,e)=>(t[e+"Error"]=T[e],t),{}),zt=bn.reduce((t,e)=>(["Syntax","Type","Range"].indexOf(e)===-1&&(t[e+"Error"]=T[e]),t),{});function K(){}function ct(t){return t}function Vi(t,e){return t==null||t===ct?e:function(r){return e(t(r))}}function Re(t,e){return function(){t.apply(this,arguments),e.apply(this,arguments)}}function zi(t,e){return t===K?e:function(){var r=t.apply(this,arguments);r!==void 0&&(arguments[0]=r);var n=this.onsuccess,o=this.onerror;this.onsuccess=null,this.onerror=null;var i=e.apply(this,arguments);return n&&(this.onsuccess=this.onsuccess?Re(n,this.onsuccess):n),o&&(this.onerror=this.onerror?Re(o,this.onerror):o),i!==void 0?i:r}}function Yi(t,e){return t===K?e:function(){t.apply(this,arguments);var r=this.onsuccess,n=this.onerror;this.onsuccess=this.onerror=null,e.apply(this,arguments),r&&(this.onsuccess=this.onsuccess?Re(r,this.onsuccess):r),n&&(this.onerror=this.onerror?Re(n,this.onerror):n)}}function Xi(t,e){return t===K?e:function(r){var n=t.apply(this,arguments);z(r,n);var o=this.onsuccess,i=this.onerror;this.onsuccess=null,this.onerror=null;var s=e.apply(this,arguments);return o&&(this.onsuccess=this.onsuccess?Re(o,this.onsuccess):o),i&&(this.onerror=this.onerror?Re(i,this.onerror):i),n===void 0?s===void 0?void 0:s:z(n,s)}}function Gi(t,e){return t===K?e:function(){return e.apply(this,arguments)!==!1&&t.apply(this,arguments)}}function gn(t,e){return t===K?e:function(){var r=t.apply(this,arguments);if(r&&typeof r.then=="function"){for(var n=this,o=arguments.length,i=new Array(o);o--;)i[o]=arguments[o];return r.then(function(){return e.apply(n,i)})}return e.apply(this,arguments)}}zt.ModifyError=tr,zt.DexieError=We,zt.BulkError=nt;var lt={},Fo=100,[$r,rr,Ur]=typeof Promise>"u"?[]:(()=>{let t=Promise.resolve();if(typeof crypto>"u"||!crypto.subtle)return[t,ut(t),t];let e=crypto.subtle.digest("SHA-512",new Uint8Array([0]));return[e,ut(e),t]})(),Bo=rr&&rr.then,Yt=$r&&$r.constructor,xn=!!Ur,Wr=!1,Ji=Ur?()=>{Ur.then(Lt)}:M.setImmediate?setImmediate.bind(null,Lt):M.MutationObserver?()=>{var t=document.createElement("div");new MutationObserver(()=>{Lt(),t=null}).observe(t,{attributes:!0}),t.setAttribute("i","1")}:()=>{setTimeout(Lt,0)},ot=function(t,e){rt.push([t,e]),nr&&(Ji(),nr=!1)},Hr=!0,nr=!0,Ae=[],Xt=[],Vr=null,zr=ct,He={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:yo,pgp:!1,env:{},finalize:function(){this.unhandleds.forEach(t=>{try{yo(t[0],t[1])}catch{}})}},S=He,rt=[],je=0,Gt=[];function k(t){if(typeof this!="object")throw new TypeError("Promises must be constructed via new");this._listeners=[],this.onuncatched=K,this._lib=!1;var e=this._PSD=S;if(ne&&(this._stackHolder=Ce(),this._prev=null,this._numPrev=0),typeof t!="function"){if(t!==lt)throw new TypeError("Not a function");return this._state=arguments[1],this._value=arguments[2],void(this._state===!1&&Xr(this,this._value))}this._state=null,this._value=null,++e.ref,No(this,t)}var Yr={get:function(){var t=S,e=or;function r(n,o){var i=!t.global&&(t!==S||e!==or);let s=i&&!pe();var u=new k((a,l)=>{_n(this,new Mo(ir(n,t,i,s),ir(o,t,i,s),a,l,t))});return ne&&$o(u,this),u}return r.prototype=lt,r},set:function(t){le(this,"then",t&&t.prototype===lt?Yr:{get:function(){return t},set:Yr.set})}};function Mo(t,e,r,n,o){this.onFulfilled=typeof t=="function"?t:null,this.onRejected=typeof e=="function"?e:null,this.resolve=r,this.reject=n,this.psd=o}function No(t,e){try{e(r=>{if(t._state===null){if(r===t)throw new TypeError("A promise cannot be resolved with itself.");var n=t._lib&&yt();r&&typeof r.then=="function"?No(t,(o,i)=>{r instanceof k?r._then(o,i):r.then(o,i)}):(t._state=!0,t._value=r,Lo(t)),n&&bt()}},Xr.bind(null,t))}catch(r){Xr(t,r)}}function Xr(t,e){if(Xt.push(e),t._state===null){var r=t._lib&&yt();e=zr(e),t._state=!1,t._value=e,ne&&e!==null&&typeof e=="object"&&!e._promise&&function(n,o,i){try{n.apply(null,i)}catch(s){o&&o(s)}}(()=>{var n=mn(e,"stack");e._promise=t,le(e,"stack",{get:()=>Wr?n&&(n.get?n.get.apply(e):n.value):t.stack})}),function(n){Ae.some(o=>o._value===n._value)||Ae.push(n)}(t),Lo(t),r&&bt()}}function Lo(t){var e=t._listeners;t._listeners=[];for(var r=0,n=e.length;r<n;++r)_n(t,e[r]);var o=t._PSD;--o.ref||o.finalize(),je===0&&(++je,ot(()=>{--je==0&&wn()},[]))}function _n(t,e){if(t._state!==null){var r=t._state?e.onFulfilled:e.onRejected;if(r===null)return(t._state?e.resolve:e.reject)(t._value);++e.psd.ref,++je,ot(Qi,[r,t,e])}else t._listeners.push(e)}function Qi(t,e,r){try{Vr=e;var n,o=e._value;e._state?n=t(o):(Xt.length&&(Xt=[]),n=t(o),Xt.indexOf(o)===-1&&function(i){for(var s=Ae.length;s;)if(Ae[--s]._value===i._value)return void Ae.splice(s,1)}(e)),r.resolve(n)}catch(i){r.reject(i)}finally{Vr=null,--je==0&&wn(),--r.psd.ref||r.psd.finalize()}}function qo(t,e,r){if(e.length===r)return e;var n="";if(t._state===!1){var o,i,s=t._value;s!=null?(o=s.name||"Error",i=s.message||s,n=qr(s,0)):(o=s,i=""),e.push(o+(i?": "+i:"")+n)}return ne&&((n=qr(t._stackHolder,2))&&e.indexOf(n)===-1&&e.push(n),t._prev&&qo(t._prev,e,r)),e}function $o(t,e){var r=e?e._numPrev+1:0;r<100&&(t._prev=e,t._numPrev=r)}function Lt(){yt()&&bt()}function yt(){var t=Hr;return Hr=!1,nr=!1,t}function bt(){var t,e,r;do for(;rt.length>0;)for(t=rt,rt=[],r=t.length,e=0;e<r;++e){var n=t[e];n[0].apply(null,n[1])}while(rt.length>0);Hr=!0,nr=!0}function wn(){var t=Ae;Ae=[],t.forEach(n=>{n._PSD.onunhandled.call(null,n._value,n)});for(var e=Gt.slice(0),r=e.length;r;)e[--r]()}function qt(t){return new k(lt,!1,t)}function L(t,e){var r=S;return function(){var n=yt(),o=S;try{return xe(r,!0),t.apply(this,arguments)}catch(i){e&&e(i)}finally{xe(o,!1),n&&bt()}}}Ve(k.prototype,{then:Yr,_then:function(t,e){_n(this,new Mo(null,null,t,e,S))},catch:function(t){if(arguments.length===1)return this.then(null,t);var e=arguments[0],r=arguments[1];return typeof e=="function"?this.then(null,n=>n instanceof e?r(n):qt(n)):this.then(null,n=>n&&n.name===e?r(n):qt(n))},finally:function(t){return this.then(e=>(t(),e),e=>(t(),qt(e)))},stack:{get:function(){if(this._stack)return this._stack;try{Wr=!0;var t=qo(this,[],20).join(`
From previous: `);return this._state!==null&&(this._stack=t),t}finally{Wr=!1}}},timeout:function(t,e){return t<1/0?new k((r,n)=>{var o=setTimeout(()=>n(new T.Timeout(e)),t);this.then(r,n).finally(clearTimeout.bind(null,o))}):this}}),typeof Symbol<"u"&&Symbol.toStringTag&&le(k.prototype,Symbol.toStringTag,"Dexie.Promise"),He.env=Uo(),Ve(k,{all:function(){var t=ue.apply(null,arguments).map($t);return new k(function(e,r){t.length===0&&e([]);var n=t.length;t.forEach((o,i)=>k.resolve(o).then(s=>{t[i]=s,--n||e(t)},r))})},resolve:t=>{if(t instanceof k)return t;if(t&&typeof t.then=="function")return new k((r,n)=>{t.then(r,n)});var e=new k(lt,!0,t);return $o(e,Vr),e},reject:qt,race:function(){var t=ue.apply(null,arguments).map($t);return new k((e,r)=>{t.map(n=>k.resolve(n).then(e,r))})},PSD:{get:()=>S,set:t=>S=t},totalEchoes:{get:()=>or},newPSD:ge,usePSD:Xe,scheduler:{get:()=>ot,set:t=>{ot=t}},rejectionMapper:{get:()=>zr,set:t=>{zr=t}},follow:(t,e)=>new k((r,n)=>ge((o,i)=>{var s=S;s.unhandleds=[],s.onunhandled=i,s.finalize=Re(function(){(function(u){function a(){u(),Gt.splice(Gt.indexOf(a),1)}Gt.push(a),++je,ot(()=>{--je==0&&wn()},[])})(()=>{this.unhandleds.length===0?o():i(this.unhandleds[0])})},s.finalize),t()},e,r,n))}),Yt&&(Yt.allSettled&&le(k,"allSettled",function(){let t=ue.apply(null,arguments).map($t);return new k(e=>{t.length===0&&e([]);let r=t.length,n=new Array(r);t.forEach((o,i)=>k.resolve(o).then(s=>n[i]={status:"fulfilled",value:s},s=>n[i]={status:"rejected",reason:s}).then(()=>--r||e(n)))})}),Yt.any&&typeof AggregateError<"u"&&le(k,"any",function(){let t=ue.apply(null,arguments).map($t);return new k((e,r)=>{t.length===0&&r(new AggregateError([]));let n=t.length,o=new Array(n);t.forEach((i,s)=>k.resolve(i).then(u=>e(u),u=>{o[s]=u,--n||r(new AggregateError(o))}))})}));var W={awaits:0,echoes:0,id:0},Zi=0,Jt=[],Rr=0,or=0,es=0;function ge(t,e,r,n){var o=S,i=Object.create(o);i.parent=o,i.ref=0,i.global=!1,i.id=++es;var s=He.env;i.env=xn?{Promise:k,PromiseProp:{value:k,configurable:!0,writable:!0},all:k.all,race:k.race,allSettled:k.allSettled,any:k.any,resolve:k.resolve,reject:k.reject,nthen:ho(s.nthen,i),gthen:ho(s.gthen,i)}:{},e&&z(i,e),++o.ref,i.finalize=function(){--this.parent.ref||this.parent.finalize()};var u=Xe(i,t,r,n);return i.ref===0&&i.finalize(),u}function Ye(){return W.id||(W.id=++Zi),++W.awaits,W.echoes+=Fo,W.id}function pe(){return!!W.awaits&&(--W.awaits==0&&(W.id=0),W.echoes=W.awaits*Fo,!0)}function $t(t){return W.echoes&&t&&t.constructor===Yt?(Ye(),t.then(e=>(pe(),e),e=>(pe(),$(e)))):t}function ts(t){++or,W.echoes&&--W.echoes!=0||(W.echoes=W.id=0),Jt.push(S),xe(t,!0)}function rs(){var t=Jt[Jt.length-1];Jt.pop(),xe(t,!1)}function xe(t,e){var r=S;if((e?!W.echoes||Rr++&&t===S:!Rr||--Rr&&t===S)||Wo(e?ts.bind(null,t):rs),t!==S&&(S=t,r===He&&(He.env=Uo()),xn)){var n=He.env.Promise,o=t.env;rr.then=o.nthen,n.prototype.then=o.gthen,(r.global||t.global)&&(Object.defineProperty(M,"Promise",o.PromiseProp),n.all=o.all,n.race=o.race,n.resolve=o.resolve,n.reject=o.reject,o.allSettled&&(n.allSettled=o.allSettled),o.any&&(n.any=o.any))}}function Uo(){var t=M.Promise;return xn?{Promise:t,PromiseProp:Object.getOwnPropertyDescriptor(M,"Promise"),all:t.all,race:t.race,allSettled:t.allSettled,any:t.any,resolve:t.resolve,reject:t.reject,nthen:rr.then,gthen:t.prototype.then}:{}}function Xe(t,e,r,n,o){var i=S;try{return xe(t,!0),e(r,n,o)}finally{xe(i,!1)}}function Wo(t){Bo.call($r,t)}function ir(t,e,r,n){return typeof t!="function"?t:function(){var o=S;r&&Ye(),xe(e,!0);try{return t.apply(this,arguments)}finally{xe(o,!1),n&&Wo(pe)}}}function ho(t,e){return function(r,n){return t.call(this,ir(r,e),ir(n,e))}}(""+Bo).indexOf("[native code]")===-1&&(Ye=pe=K);var mo="unhandledrejection";function yo(t,e){var r;try{r=e.onuncatched(t)}catch{}if(r!==!1)try{var n,o={promise:e,reason:t};if(M.document&&document.createEvent?((n=document.createEvent("Event")).initEvent(mo,!0,!0),z(n,o)):M.CustomEvent&&z(n=new CustomEvent(mo,{detail:o}),o),n&&M.dispatchEvent&&(dispatchEvent(n),!M.PromiseRejectionEvent&&M.onunhandledrejection))try{M.onunhandledrejection(n)}catch{}ne&&n&&!n.defaultPrevented&&console.warn(`Unhandled rejection: ${t.stack||t}`)}catch{}}var $=k.reject;function Gr(t,e,r,n){if(t.idbdb&&(t._state.openComplete||S.letThrough||t._vip)){var o=t._createTransaction(e,r,t._dbSchema);try{o.create(),t._state.PR1398_maxLoop=3}catch(i){return i.name===vn.InvalidState&&t.isOpen()&&--t._state.PR1398_maxLoop>0?(console.warn("Dexie: Need to reopen db"),t._close(),t.open().then(()=>Gr(t,e,r,n))):$(i)}return o._promise(e,(i,s)=>ge(()=>(S.trans=o,n(i,s,o)))).then(i=>o._completion.then(()=>i))}if(t._state.openComplete)return $(new T.DatabaseClosed(t._state.dbOpenError));if(!t._state.isBeingOpened){if(!t._options.autoOpen)return $(new T.DatabaseClosed);t.open().catch(K)}return t._state.dbReadyPromise.then(()=>Gr(t,e,r,n))}var bo="3.2.4",Te="\uFFFF",Jr=-1/0,se="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",Ho="String expected.",it=[],cr=typeof navigator<"u"&&/(MSIE|Trident|Edge)/.test(navigator.userAgent),ns=cr,os=cr,Vo=t=>!/(dexie\.js|dexie\.min\.js)/.test(t),lr="__dbnames",Ir="readonly",Cr="readwrite";function Ie(t,e){return t?e?function(){return t.apply(this,arguments)&&e.apply(this,arguments)}:t:e}var zo={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function Ut(t){return typeof t!="string"||/\./.test(t)?e=>e:e=>(e[t]===void 0&&t in e&&delete(e=mt(e))[t],e)}var Qr=class{_trans(e,r,n){let o=this._tx||S.trans,i=this.name;function s(a,l,c){if(!c.schema[i])throw new T.NotFound("Table "+i+" not part of transaction");return r(c.idbtrans,c)}let u=yt();try{return o&&o.db===this.db?o===S.trans?o._promise(e,s,n):ge(()=>o._promise(e,s,n),{trans:o,transless:S.transless||S}):Gr(this.db,e,[this.name],s)}finally{u&&bt()}}get(e,r){return e&&e.constructor===Object?this.where(e).first(r):this._trans("readonly",n=>this.core.get({trans:n,key:e}).then(o=>this.hook.reading.fire(o))).then(r)}where(e){if(typeof e=="string")return new this.db.WhereClause(this,e);if(H(e))return new this.db.WhereClause(this,`[${e.join("+")}]`);let r=q(e);if(r.length===1)return this.where(r[0]).equals(e[r[0]]);let n=this.schema.indexes.concat(this.schema.primKey).filter(l=>l.compound&&r.every(c=>l.keyPath.indexOf(c)>=0)&&l.keyPath.every(c=>r.indexOf(c)>=0))[0];if(n&&this.db._maxKey!==Te)return this.where(n.name).equals(n.keyPath.map(l=>e[l]));!n&&ne&&console.warn(`The query ${JSON.stringify(e)} on ${this.name} would benefit of a compound index [${r.join("+")}]`);let{idxByName:o}=this.schema,i=this.db._deps.indexedDB;function s(l,c){try{return i.cmp(l,c)===0}catch{return!1}}let[u,a]=r.reduce(([l,c],f)=>{let p=o[f],h=e[f];return[l||p,l||!p?Ie(c,p&&p.multi?v=>{let d=fe(v,f);return H(d)&&d.some(b=>s(h,b))}:v=>s(h,fe(v,f))):c]},[null,null]);return u?this.where(u.name).equals(e[u.keyPath]).filter(a):n?this.filter(a):this.where(r).equals("")}filter(e){return this.toCollection().and(e)}count(e){return this.toCollection().count(e)}offset(e){return this.toCollection().offset(e)}limit(e){return this.toCollection().limit(e)}each(e){return this.toCollection().each(e)}toArray(e){return this.toCollection().toArray(e)}toCollection(){return new this.db.Collection(new this.db.WhereClause(this))}orderBy(e){return new this.db.Collection(new this.db.WhereClause(this,H(e)?`[${e.join("+")}]`:e))}reverse(){return this.toCollection().reverse()}mapToClass(e){this.schema.mappedClass=e;let r=n=>{if(!n)return n;let o=Object.create(e.prototype);for(var i in n)if(J(n,i))try{o[i]=n[i]}catch{}return o};return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=r,this.hook("reading",r),e}defineClass(){return this.mapToClass(function(e){z(this,e)})}add(e,r){let{auto:n,keyPath:o}=this.schema.primKey,i=e;return o&&n&&(i=Ut(o)(e)),this._trans("readwrite",s=>this.core.mutate({trans:s,type:"add",keys:r!=null?[r]:null,values:[i]})).then(s=>s.numFailures?k.reject(s.failures[0]):s.lastResult).then(s=>{if(o)try{Z(e,o,s)}catch{}return s})}update(e,r){if(typeof e!="object"||H(e))return this.where(":id").equals(e).modify(r);{let n=fe(e,this.schema.primKey.keyPath);if(n===void 0)return $(new T.InvalidArgument("Given object does not contain its primary key"));try{typeof r!="function"?q(r).forEach(o=>{Z(e,o,r[o])}):r(e,{value:e,primKey:n})}catch{}return this.where(":id").equals(n).modify(r)}}put(e,r){let{auto:n,keyPath:o}=this.schema.primKey,i=e;return o&&n&&(i=Ut(o)(e)),this._trans("readwrite",s=>this.core.mutate({trans:s,type:"put",values:[i],keys:r!=null?[r]:null})).then(s=>s.numFailures?k.reject(s.failures[0]):s.lastResult).then(s=>{if(o)try{Z(e,o,s)}catch{}return s})}delete(e){return this._trans("readwrite",r=>this.core.mutate({trans:r,type:"delete",keys:[e]})).then(r=>r.numFailures?k.reject(r.failures[0]):void 0)}clear(){return this._trans("readwrite",e=>this.core.mutate({trans:e,type:"deleteRange",range:zo})).then(e=>e.numFailures?k.reject(e.failures[0]):void 0)}bulkGet(e){return this._trans("readonly",r=>this.core.getMany({keys:e,trans:r}).then(n=>n.map(o=>this.hook.reading.fire(o))))}bulkAdd(e,r,n){let o=Array.isArray(r)?r:void 0,i=(n=n||(o?void 0:r))?n.allKeys:void 0;return this._trans("readwrite",s=>{let{auto:u,keyPath:a}=this.schema.primKey;if(a&&o)throw new T.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(o&&o.length!==e.length)throw new T.InvalidArgument("Arguments objects and keys must have the same length");let l=e.length,c=a&&u?e.map(Ut(a)):e;return this.core.mutate({trans:s,type:"add",keys:o,values:c,wantResults:i}).then(({numFailures:f,results:p,lastResult:h,failures:v})=>{if(f===0)return i?p:h;throw new nt(`${this.name}.bulkAdd(): ${f} of ${l} operations failed`,v)})})}bulkPut(e,r,n){let o=Array.isArray(r)?r:void 0,i=(n=n||(o?void 0:r))?n.allKeys:void 0;return this._trans("readwrite",s=>{let{auto:u,keyPath:a}=this.schema.primKey;if(a&&o)throw new T.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(o&&o.length!==e.length)throw new T.InvalidArgument("Arguments objects and keys must have the same length");let l=e.length,c=a&&u?e.map(Ut(a)):e;return this.core.mutate({trans:s,type:"put",keys:o,values:c,wantResults:i}).then(({numFailures:f,results:p,lastResult:h,failures:v})=>{if(f===0)return i?p:h;throw new nt(`${this.name}.bulkPut(): ${f} of ${l} operations failed`,v)})})}bulkDelete(e){let r=e.length;return this._trans("readwrite",n=>this.core.mutate({trans:n,type:"delete",keys:e})).then(({numFailures:n,lastResult:o,failures:i})=>{if(n===0)return o;throw new nt(`${this.name}.bulkDelete(): ${n} of ${r} operations failed`,i)})}};function st(t){var e={},r=function(s,u){if(u){for(var a=arguments.length,l=new Array(a-1);--a;)l[a-1]=arguments[a];return e[s].subscribe.apply(null,l),t}if(typeof s=="string")return e[s]};r.addEventType=i;for(var n=1,o=arguments.length;n<o;++n)i(arguments[n]);return r;function i(s,u,a){if(typeof s!="object"){var l;u||(u=Gi),a||(a=K);var c={subscribers:[],fire:a,subscribe:function(f){c.subscribers.indexOf(f)===-1&&(c.subscribers.push(f),c.fire=u(c.fire,f))},unsubscribe:function(f){c.subscribers=c.subscribers.filter(function(p){return p!==f}),c.fire=c.subscribers.reduce(u,a)}};return e[s]=r[s]=c,c}q(l=s).forEach(function(f){var p=l[f];if(H(p))i(f,l[f][0],l[f][1]);else{if(p!=="asap")throw new T.InvalidArgument("Invalid event config");var h=i(f,ct,function(){for(var v=arguments.length,d=new Array(v);v--;)d[v]=arguments[v];h.subscribers.forEach(function(b){Po(function(){b.apply(null,d)})})})}})}}function et(t,e){return Ue(e).from({prototype:t}),e}function Le(t,e){return!(t.filter||t.algorithm||t.or)&&(e?t.justLimit:!t.replayFilter)}function Kr(t,e){t.filter=Ie(t.filter,e)}function Dr(t,e,r){var n=t.replayFilter;t.replayFilter=n?()=>Ie(n(),e()):e,t.justLimit=r&&!n}function Qt(t,e){if(t.isPrimKey)return e.primaryKey;let r=e.getIndexByKeyPath(t.index);if(!r)throw new T.Schema("KeyPath "+t.index+" on object store "+e.name+" is not indexed");return r}function vo(t,e,r){let n=Qt(t,e.schema);return e.openCursor({trans:r,values:!t.keysOnly,reverse:t.dir==="prev",unique:!!t.unique,query:{index:n,range:t.range}})}function Wt(t,e,r,n){let o=t.replayFilter?Ie(t.filter,t.replayFilter()):t.filter;if(t.or){let i={},s=(u,a,l)=>{if(!o||o(a,l,p=>a.stop(p),p=>a.fail(p))){var c=a.primaryKey,f=""+c;f==="[object ArrayBuffer]"&&(f=""+new Uint8Array(c)),J(i,f)||(i[f]=!0,e(u,a,l))}};return Promise.all([t.or._iterate(s,r),go(vo(t,n,r),t.algorithm,s,!t.keysOnly&&t.valueMapper)])}return go(vo(t,n,r),Ie(t.algorithm,o),e,!t.keysOnly&&t.valueMapper)}function go(t,e,r,n){var o=L(n?(i,s,u)=>r(n(i),s,u):r);return t.then(i=>{if(i)return i.start(()=>{var s=()=>i.continue();e&&!e(i,u=>s=u,u=>{i.stop(u),s=K},u=>{i.fail(u),s=K})||o(i.value,i,u=>s=u),s()})})}function V(t,e){try{let r=xo(t),n=xo(e);if(r!==n)return r==="Array"?1:n==="Array"?-1:r==="binary"?1:n==="binary"?-1:r==="string"?1:n==="string"?-1:r==="Date"?1:n!=="Date"?NaN:-1;switch(r){case"number":case"Date":case"string":return t>e?1:t<e?-1:0;case"binary":return function(o,i){let s=o.length,u=i.length,a=s<u?s:u;for(let l=0;l<a;++l)if(o[l]!==i[l])return o[l]<i[l]?-1:1;return s===u?0:s<u?-1:1}(_o(t),_o(e));case"Array":return function(o,i){let s=o.length,u=i.length,a=s<u?s:u;for(let l=0;l<a;++l){let c=V(o[l],i[l]);if(c!==0)return c}return s===u?0:s<u?-1:1}(t,e)}}catch{}return NaN}function xo(t){let e=typeof t;if(e!=="object")return e;if(ArrayBuffer.isView(t))return"binary";let r=Nr(t);return r==="ArrayBuffer"?"binary":r}function _o(t){return t instanceof Uint8Array?t:ArrayBuffer.isView(t)?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):new Uint8Array(t)}var Zr=class{_read(e,r){var n=this._ctx;return n.error?n.table._trans(null,$.bind(null,n.error)):n.table._trans("readonly",e).then(r)}_write(e){var r=this._ctx;return r.error?r.table._trans(null,$.bind(null,r.error)):r.table._trans("readwrite",e,"locked")}_addAlgorithm(e){var r=this._ctx;r.algorithm=Ie(r.algorithm,e)}_iterate(e,r){return Wt(this._ctx,e,r,this._ctx.table.core)}clone(e){var r=Object.create(this.constructor.prototype),n=Object.create(this._ctx);return e&&z(n,e),r._ctx=n,r}raw(){return this._ctx.valueMapper=null,this}each(e){var r=this._ctx;return this._read(n=>Wt(r,e,n,r.table.core))}count(e){return this._read(r=>{let n=this._ctx,o=n.table.core;if(Le(n,!0))return o.count({trans:r,query:{index:Qt(n,o.schema),range:n.range}}).then(s=>Math.min(s,n.limit));var i=0;return Wt(n,()=>(++i,!1),r,o).then(()=>i)}).then(e)}sortBy(e,r){let n=e.split(".").reverse(),o=n[0],i=n.length-1;function s(l,c){return c?s(l[n[c]],c-1):l[o]}var u=this._ctx.dir==="next"?1:-1;function a(l,c){var f=s(l,i),p=s(c,i);return f<p?-u:f>p?u:0}return this.toArray(function(l){return l.sort(a)}).then(r)}toArray(e){return this._read(r=>{var n=this._ctx;if(n.dir==="next"&&Le(n,!0)&&n.limit>0){let{valueMapper:o}=n,i=Qt(n,n.table.core.schema);return n.table.core.query({trans:r,limit:n.limit,values:!0,query:{index:i,range:n.range}}).then(({result:s})=>o?s.map(o):s)}{let o=[];return Wt(n,i=>o.push(i),r,n.table.core).then(()=>o)}},e)}offset(e){var r=this._ctx;return e<=0||(r.offset+=e,Le(r)?Dr(r,()=>{var n=e;return(o,i)=>n===0||(n===1?(--n,!1):(i(()=>{o.advance(n),n=0}),!1))}):Dr(r,()=>{var n=e;return()=>--n<0})),this}limit(e){return this._ctx.limit=Math.min(this._ctx.limit,e),Dr(this._ctx,()=>{var r=e;return function(n,o,i){return--r<=0&&o(i),r>=0}},!0),this}until(e,r){return Kr(this._ctx,function(n,o,i){return!e(n.value)||(o(i),r)}),this}first(e){return this.limit(1).toArray(function(r){return r[0]}).then(e)}last(e){return this.reverse().first(e)}filter(e){var r,n;return Kr(this._ctx,function(o){return e(o.value)}),r=this._ctx,n=e,r.isMatch=Ie(r.isMatch,n),this}and(e){return this.filter(e)}or(e){return new this.db.WhereClause(this._ctx.table,e,this)}reverse(){return this._ctx.dir=this._ctx.dir==="prev"?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this}desc(){return this.reverse()}eachKey(e){var r=this._ctx;return r.keysOnly=!r.isMatch,this.each(function(n,o){e(o.key,o)})}eachUniqueKey(e){return this._ctx.unique="unique",this.eachKey(e)}eachPrimaryKey(e){var r=this._ctx;return r.keysOnly=!r.isMatch,this.each(function(n,o){e(o.primaryKey,o)})}keys(e){var r=this._ctx;r.keysOnly=!r.isMatch;var n=[];return this.each(function(o,i){n.push(i.key)}).then(function(){return n}).then(e)}primaryKeys(e){var r=this._ctx;if(r.dir==="next"&&Le(r,!0)&&r.limit>0)return this._read(o=>{var i=Qt(r,r.table.core.schema);return r.table.core.query({trans:o,values:!1,limit:r.limit,query:{index:i,range:r.range}})}).then(({result:o})=>o).then(e);r.keysOnly=!r.isMatch;var n=[];return this.each(function(o,i){n.push(i.primaryKey)}).then(function(){return n}).then(e)}uniqueKeys(e){return this._ctx.unique="unique",this.keys(e)}firstKey(e){return this.limit(1).keys(function(r){return r[0]}).then(e)}lastKey(e){return this.reverse().firstKey(e)}distinct(){var e=this._ctx,r=e.index&&e.table.schema.idxByName[e.index];if(!r||!r.multi)return this;var n={};return Kr(this._ctx,function(o){var i=o.primaryKey.toString(),s=J(n,i);return n[i]=!0,!s}),this}modify(e){var r=this._ctx;return this._write(n=>{var o;if(typeof e=="function")o=e;else{var i=q(e),s=i.length;o=function(d){for(var b=!1,m=0;m<s;++m){var y=i[m],_=e[y];fe(d,y)!==_&&(Z(d,y,_),b=!0)}return b}}let u=r.table.core,{outbound:a,extractKey:l}=u.schema.primaryKey,c=this.db._options.modifyChunkSize||200,f=[],p=0,h=[],v=(d,b)=>{let{failures:m,numFailures:y}=b;p+=d-y;for(let _ of q(m))f.push(m[_])};return this.clone().primaryKeys().then(d=>{let b=m=>{let y=Math.min(c,d.length-m);return u.getMany({trans:n,keys:d.slice(m,m+y),cache:"immutable"}).then(_=>{let g=[],E=[],O=a?[]:null,x=[];for(let w=0;w<y;++w){let F=_[w],P={value:mt(F),primKey:d[m+w]};o.call(P,P.value,P)!==!1&&(P.value==null?x.push(d[m+w]):a||V(l(F),l(P.value))===0?(E.push(P.value),a&&O.push(d[m+w])):(x.push(d[m+w]),g.push(P.value)))}let A=Le(r)&&r.limit===1/0&&(typeof e!="function"||e===Fr)&&{index:r.index,range:r.range};return Promise.resolve(g.length>0&&u.mutate({trans:n,type:"add",values:g}).then(w=>{for(let F in w.failures)x.splice(parseInt(F),1);v(g.length,w)})).then(()=>(E.length>0||A&&typeof e=="object")&&u.mutate({trans:n,type:"put",keys:O,values:E,criteria:A,changeSpec:typeof e!="function"&&e}).then(w=>v(E.length,w))).then(()=>(x.length>0||A&&e===Fr)&&u.mutate({trans:n,type:"delete",keys:x,criteria:A}).then(w=>v(x.length,w))).then(()=>d.length>m+y&&b(m+c))})};return b(0).then(()=>{if(f.length>0)throw new tr("Error modifying one or more objects",f,p,h);return d.length})})})}delete(){var e=this._ctx,r=e.range;return Le(e)&&(e.isPrimKey&&!os||r.type===3)?this._write(n=>{let{primaryKey:o}=e.table.core.schema,i=r;return e.table.core.count({trans:n,query:{index:o,range:i}}).then(s=>e.table.core.mutate({trans:n,type:"deleteRange",range:i}).then(({failures:u,lastResult:a,results:l,numFailures:c})=>{if(c)throw new tr("Could not delete some values",Object.keys(u).map(f=>u[f]),s-c);return s-c}))}):this.modify(Fr)}},Fr=(t,e)=>e.value=null;function is(t,e){return t<e?-1:t===e?0:1}function ss(t,e){return t>e?-1:t===e?0:1}function G(t,e,r){var n=t instanceof sr?new t.Collection(t):t;return n._ctx.error=r?new r(e):new TypeError(e),n}function qe(t){return new t.Collection(t,()=>Yo("")).limit(0)}function as(t,e,r,n,o,i){for(var s=Math.min(t.length,n.length),u=-1,a=0;a<s;++a){var l=e[a];if(l!==n[a])return o(t[a],r[a])<0?t.substr(0,a)+r[a]+r.substr(a+1):o(t[a],n[a])<0?t.substr(0,a)+n[a]+r.substr(a+1):u>=0?t.substr(0,u)+e[u]+r.substr(u+1):null;o(t[a],l)<0&&(u=a)}return s<n.length&&i==="next"?t+r.substr(t.length):s<t.length&&i==="prev"?t.substr(0,r.length):u<0?null:t.substr(0,u)+n[u]+r.substr(u+1)}function Ht(t,e,r,n){var o,i,s,u,a,l,c,f=r.length;if(!r.every(d=>typeof d=="string"))return G(t,Ho);function p(d){o=function(m){return m==="next"?y=>y.toUpperCase():y=>y.toLowerCase()}(d),i=function(m){return m==="next"?y=>y.toLowerCase():y=>y.toUpperCase()}(d),s=d==="next"?is:ss;var b=r.map(function(m){return{lower:i(m),upper:o(m)}}).sort(function(m,y){return s(m.lower,y.lower)});u=b.map(function(m){return m.upper}),a=b.map(function(m){return m.lower}),l=d,c=d==="next"?"":n}p("next");var h=new t.Collection(t,()=>ye(u[0],a[f-1]+n));h._ondirectionchange=function(d){p(d)};var v=0;return h._addAlgorithm(function(d,b,m){var y=d.key;if(typeof y!="string")return!1;var _=i(y);if(e(_,a,v))return!0;for(var g=null,E=v;E<f;++E){var O=as(y,_,u[E],a[E],s,l);O===null&&g===null?v=E+1:(g===null||s(g,O)>0)&&(g=O)}return b(g!==null?function(){d.continue(g+c)}:m),!1}),h}function ye(t,e,r,n){return{type:2,lower:t,upper:e,lowerOpen:r,upperOpen:n}}function Yo(t){return{type:1,lower:t,upper:t}}var sr=class{get Collection(){return this._ctx.table.db.Collection}between(e,r,n,o){n=n!==!1,o=o===!0;try{return this._cmp(e,r)>0||this._cmp(e,r)===0&&(n||o)&&(!n||!o)?qe(this):new this.Collection(this,()=>ye(e,r,!n,!o))}catch{return G(this,se)}}equals(e){return e==null?G(this,se):new this.Collection(this,()=>Yo(e))}above(e){return e==null?G(this,se):new this.Collection(this,()=>ye(e,void 0,!0))}aboveOrEqual(e){return e==null?G(this,se):new this.Collection(this,()=>ye(e,void 0,!1))}below(e){return e==null?G(this,se):new this.Collection(this,()=>ye(void 0,e,!1,!0))}belowOrEqual(e){return e==null?G(this,se):new this.Collection(this,()=>ye(void 0,e))}startsWith(e){return typeof e!="string"?G(this,Ho):this.between(e,e+Te,!0,!0)}startsWithIgnoreCase(e){return e===""?this.startsWith(e):Ht(this,(r,n)=>r.indexOf(n[0])===0,[e],Te)}equalsIgnoreCase(e){return Ht(this,(r,n)=>r===n[0],[e],"")}anyOfIgnoreCase(){var e=ue.apply($e,arguments);return e.length===0?qe(this):Ht(this,(r,n)=>n.indexOf(r)!==-1,e,"")}startsWithAnyOfIgnoreCase(){var e=ue.apply($e,arguments);return e.length===0?qe(this):Ht(this,(r,n)=>n.some(o=>r.indexOf(o)===0),e,Te)}anyOf(){let e=ue.apply($e,arguments),r=this._cmp;try{e.sort(r)}catch{return G(this,se)}if(e.length===0)return qe(this);let n=new this.Collection(this,()=>ye(e[0],e[e.length-1]));n._ondirectionchange=i=>{r=i==="next"?this._ascending:this._descending,e.sort(r)};let o=0;return n._addAlgorithm((i,s,u)=>{let a=i.key;for(;r(a,e[o])>0;)if(++o,o===e.length)return s(u),!1;return r(a,e[o])===0||(s(()=>{i.continue(e[o])}),!1)}),n}notEqual(e){return this.inAnyRange([[Jr,e],[e,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})}noneOf(){let e=ue.apply($e,arguments);if(e.length===0)return new this.Collection(this);try{e.sort(this._ascending)}catch{return G(this,se)}let r=e.reduce((n,o)=>n?n.concat([[n[n.length-1][1],o]]):[[Jr,o]],null);return r.push([e[e.length-1],this.db._maxKey]),this.inAnyRange(r,{includeLowers:!1,includeUppers:!1})}inAnyRange(e,r){let n=this._cmp,o=this._ascending,i=this._descending,s=this._min,u=this._max;if(e.length===0)return qe(this);if(!e.every(y=>y[0]!==void 0&&y[1]!==void 0&&o(y[0],y[1])<=0))return G(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",T.InvalidArgument);let a=!r||r.includeLowers!==!1,l=r&&r.includeUppers===!0,c,f=o;function p(y,_){return f(y[0],_[0])}try{c=e.reduce(function(y,_){let g=0,E=y.length;for(;g<E;++g){let O=y[g];if(n(_[0],O[1])<0&&n(_[1],O[0])>0){O[0]=s(O[0],_[0]),O[1]=u(O[1],_[1]);break}}return g===E&&y.push(_),y},[]),c.sort(p)}catch{return G(this,se)}let h=0,v=l?y=>o(y,c[h][1])>0:y=>o(y,c[h][1])>=0,d=a?y=>i(y,c[h][0])>0:y=>i(y,c[h][0])>=0,b=v,m=new this.Collection(this,()=>ye(c[0][0],c[c.length-1][1],!a,!l));return m._ondirectionchange=y=>{y==="next"?(b=v,f=o):(b=d,f=i),c.sort(p)},m._addAlgorithm((y,_,g)=>{for(var E=y.key;b(E);)if(++h,h===c.length)return _(g),!1;return!!function(O){return!v(O)&&!d(O)}(E)||(this._cmp(E,c[h][1])===0||this._cmp(E,c[h][0])===0||_(()=>{f===o?y.continue(c[h][0]):y.continue(c[h][1])}),!1)}),m}startsWithAnyOf(){let e=ue.apply($e,arguments);return e.every(r=>typeof r=="string")?e.length===0?qe(this):this.inAnyRange(e.map(r=>[r,r+Te])):G(this,"startsWithAnyOf() only works with strings")}};function re(t){return L(function(e){return ft(e),t(e.target.error),!1})}function ft(t){t.stopPropagation&&t.stopPropagation(),t.preventDefault&&t.preventDefault()}var pt="storagemutated",ve="x-storagemutated-1",_e=st(null,pt),en=class{_lock(){return tt(!S.global),++this._reculock,this._reculock!==1||S.global||(S.lockOwnerFor=this),this}_unlock(){if(tt(!S.global),--this._reculock==0)for(S.global||(S.lockOwnerFor=null);this._blockedFuncs.length>0&&!this._locked();){var e=this._blockedFuncs.shift();try{Xe(e[1],e[0])}catch{}}return this}_locked(){return this._reculock&&S.lockOwnerFor!==this}create(e){if(!this.mode)return this;let r=this.db.idbdb,n=this.db._state.dbOpenError;if(tt(!this.idbtrans),!e&&!r)switch(n&&n.name){case"DatabaseClosedError":throw new T.DatabaseClosed(n);case"MissingAPIError":throw new T.MissingAPI(n.message,n);default:throw new T.OpenFailed(n)}if(!this.active)throw new T.TransactionInactive;return tt(this._completion._state===null),(e=this.idbtrans=e||(this.db.core?this.db.core.transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability}):r.transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability}))).onerror=L(o=>{ft(o),this._reject(e.error)}),e.onabort=L(o=>{ft(o),this.active&&this._reject(new T.Abort(e.error)),this.active=!1,this.on("abort").fire(o)}),e.oncomplete=L(()=>{this.active=!1,this._resolve(),"mutatedParts"in e&&_e.storagemutated.fire(e.mutatedParts)}),this}_promise(e,r,n){if(e==="readwrite"&&this.mode!=="readwrite")return $(new T.ReadOnly("Transaction is readonly"));if(!this.active)return $(new T.TransactionInactive);if(this._locked())return new k((i,s)=>{this._blockedFuncs.push([()=>{this._promise(e,r,n).then(i,s)},S])});if(n)return ge(()=>{var i=new k((s,u)=>{this._lock();let a=r(s,u,this);a&&a.then&&a.then(s,u)});return i.finally(()=>this._unlock()),i._lib=!0,i});var o=new k((i,s)=>{var u=r(i,s,this);u&&u.then&&u.then(i,s)});return o._lib=!0,o}_root(){return this.parent?this.parent._root():this}waitFor(e){var r=this._root();let n=k.resolve(e);if(r._waitingFor)r._waitingFor=r._waitingFor.then(()=>n);else{r._waitingFor=n,r._waitingQueue=[];var o=r.idbtrans.objectStore(r.storeNames[0]);(function s(){for(++r._spinCount;r._waitingQueue.length;)r._waitingQueue.shift()();r._waitingFor&&(o.get(-1/0).onsuccess=s)})()}var i=r._waitingFor;return new k((s,u)=>{n.then(a=>r._waitingQueue.push(L(s.bind(null,a))),a=>r._waitingQueue.push(L(u.bind(null,a)))).finally(()=>{r._waitingFor===i&&(r._waitingFor=null)})})}abort(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new T.Abort))}table(e){let r=this._memoizedTables||(this._memoizedTables={});if(J(r,e))return r[e];let n=this.schema[e];if(!n)throw new T.NotFound("Table "+e+" not part of transaction");let o=new this.db.Table(e,n,this);return o.core=this.db.core.table(e),r[e]=o,o}};function tn(t,e,r,n,o,i,s){return{name:t,keyPath:e,unique:r,multi:n,auto:o,compound:i,src:(r&&!s?"&":"")+(n?"*":"")+(o?"++":"")+Xo(e)}}function Xo(t){return typeof t=="string"?t:t?"["+[].join.call(t,"+")+"]":""}function Go(t,e,r){return{name:t,primKey:e,indexes:r,mappedClass:null,idxByName:To(r,n=>[n.name,n])}}var ht=t=>{try{return t.only([[]]),ht=()=>[[]],[[]]}catch{return ht=()=>Te,Te}};function rn(t){return t==null?()=>{}:typeof t=="string"?function(e){return e.split(".").length===1?n=>n[e]:n=>fe(n,e)}(t):e=>fe(e,t)}function wo(t){return[].slice.call(t)}var us=0;function at(t){return t==null?":id":typeof t=="string"?t:`[${t.join("+")}]`}function cs(t,e,r){function n(a){if(a.type===3)return null;if(a.type===4)throw new Error("Cannot convert never type to IDBKeyRange");let{lower:l,upper:c,lowerOpen:f,upperOpen:p}=a;return l===void 0?c===void 0?null:e.upperBound(c,!!p):c===void 0?e.lowerBound(l,!!f):e.bound(l,c,!!f,!!p)}let{schema:o,hasGetAll:i}=function(a,l){let c=wo(a.objectStoreNames);return{schema:{name:a.name,tables:c.map(f=>l.objectStore(f)).map(f=>{let{keyPath:p,autoIncrement:h}=f,v=H(p),d=p==null,b={},m={name:f.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:d,compound:v,keyPath:p,autoIncrement:h,unique:!0,extractKey:rn(p)},indexes:wo(f.indexNames).map(y=>f.index(y)).map(y=>{let{name:_,unique:g,multiEntry:E,keyPath:O}=y,x={name:_,compound:H(O),keyPath:O,unique:g,multiEntry:E,extractKey:rn(O)};return b[at(O)]=x,x}),getIndexByKeyPath:y=>b[at(y)]};return b[":id"]=m.primaryKey,p!=null&&(b[at(p)]=m.primaryKey),m})},hasGetAll:c.length>0&&"getAll"in l.objectStore(c[0])&&!(typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)}}(t,r),s=o.tables.map(a=>function(l){let c=l.name;return{name:c,schema:l,mutate:function({trans:f,type:p,keys:h,values:v,range:d}){return new Promise((b,m)=>{b=L(b);let y=f.objectStore(c),_=y.keyPath==null,g=p==="put"||p==="add";if(!g&&p!=="delete"&&p!=="deleteRange")throw new Error("Invalid operation type: "+p);let{length:E}=h||v||{length:1};if(h&&v&&h.length!==v.length)throw new Error("Given keys array must have same length as given values array.");if(E===0)return b({numFailures:0,failures:{},results:[],lastResult:void 0});let O,x=[],A=[],w=0,F=R=>{++w,ft(R)};if(p==="deleteRange"){if(d.type===4)return b({numFailures:w,failures:A,results:[],lastResult:void 0});d.type===3?x.push(O=y.clear()):x.push(O=y.delete(n(d)))}else{let[R,I]=g?_?[v,h]:[v,null]:[h,null];if(g)for(let C=0;C<E;++C)x.push(O=I&&I[C]!==void 0?y[p](R[C],I[C]):y[p](R[C])),O.onerror=F;else for(let C=0;C<E;++C)x.push(O=y[p](R[C])),O.onerror=F}let P=R=>{let I=R.target.result;x.forEach((C,oe)=>C.error!=null&&(A[oe]=C.error)),b({numFailures:w,failures:A,results:p==="delete"?h:x.map(C=>C.result),lastResult:I})};O.onerror=R=>{F(R),P(R)},O.onsuccess=P})},getMany:({trans:f,keys:p})=>new Promise((h,v)=>{h=L(h);let d=f.objectStore(c),b=p.length,m=new Array(b),y,_=0,g=0,E=x=>{let A=x.target;m[A._pos]=A.result,++g===_&&h(m)},O=re(v);for(let x=0;x<b;++x)p[x]!=null&&(y=d.get(p[x]),y._pos=x,y.onsuccess=E,y.onerror=O,++_);_===0&&h(m)}),get:({trans:f,key:p})=>new Promise((h,v)=>{h=L(h);let d=f.objectStore(c).get(p);d.onsuccess=b=>h(b.target.result),d.onerror=re(v)}),query:function(f){return p=>new Promise((h,v)=>{h=L(h);let{trans:d,values:b,limit:m,query:y}=p,_=m===1/0?void 0:m,{index:g,range:E}=y,O=d.objectStore(c),x=g.isPrimaryKey?O:O.index(g.name),A=n(E);if(m===0)return h({result:[]});if(f){let w=b?x.getAll(A,_):x.getAllKeys(A,_);w.onsuccess=F=>h({result:F.target.result}),w.onerror=re(v)}else{let w=0,F=b||!("openKeyCursor"in x)?x.openCursor(A):x.openKeyCursor(A),P=[];F.onsuccess=R=>{let I=F.result;return I?(P.push(b?I.value:I.primaryKey),++w===m?h({result:P}):void I.continue()):h({result:P})},F.onerror=re(v)}})}(i),openCursor:function({trans:f,values:p,query:h,reverse:v,unique:d}){return new Promise((b,m)=>{b=L(b);let{index:y,range:_}=h,g=f.objectStore(c),E=y.isPrimaryKey?g:g.index(y.name),O=v?d?"prevunique":"prev":d?"nextunique":"next",x=p||!("openKeyCursor"in E)?E.openCursor(n(_),O):E.openKeyCursor(n(_),O);x.onerror=re(m),x.onsuccess=L(A=>{let w=x.result;if(!w)return void b(null);w.___id=++us,w.done=!1;let F=w.continue.bind(w),P=w.continuePrimaryKey;P&&(P=P.bind(w));let R=w.advance.bind(w),I=()=>{throw new Error("Cursor not stopped")};w.trans=f,w.stop=w.continue=w.continuePrimaryKey=w.advance=()=>{throw new Error("Cursor not started")},w.fail=L(m),w.next=function(){let C=1;return this.start(()=>C--?this.continue():this.stop()).then(()=>this)},w.start=C=>{let oe=new Promise((Y,we)=>{Y=L(Y),x.onerror=re(we),w.fail=we,w.stop=Ge=>{w.stop=w.continue=w.continuePrimaryKey=w.advance=I,Y(Ge)}}),he=()=>{if(x.result)try{C()}catch(Y){w.fail(Y)}else w.done=!0,w.start=()=>{throw new Error("Cursor behind last entry")},w.stop()};return x.onsuccess=L(Y=>{x.onsuccess=he,he()}),w.continue=F,w.continuePrimaryKey=P,w.advance=R,he(),oe},b(w)},m)})},count({query:f,trans:p}){let{index:h,range:v}=f;return new Promise((d,b)=>{let m=p.objectStore(c),y=h.isPrimaryKey?m:m.index(h.name),_=n(v),g=_?y.count(_):y.count();g.onsuccess=L(E=>d(E.target.result)),g.onerror=re(b)})}}}(a)),u={};return s.forEach(a=>u[a.name]=a),{stack:"dbcore",transaction:t.transaction.bind(t),table(a){if(!u[a])throw new Error(`Table '${a}' not found`);return u[a]},MIN_KEY:-1/0,MAX_KEY:ht(e),schema:o}}function nn({_novip:t},e){let r=e.db,n=function(o,i,{IDBKeyRange:s,indexedDB:u},a){return{dbcore:function(c,f){return f.reduce((p,{create:h})=>({...p,...h(p)}),c)}(cs(i,s,a),o.dbcore)}}(t._middlewares,r,t._deps,e);t.core=n.dbcore,t.tables.forEach(o=>{let i=o.name;t.core.schema.tables.some(s=>s.name===i)&&(o.core=t.core.table(i),t[i]instanceof t.Table&&(t[i].core=o.core))})}function ar({_novip:t},e,r,n){r.forEach(o=>{let i=n[o];e.forEach(s=>{let u=mn(s,o);(!u||"value"in u&&u.value===void 0)&&(s===t.Transaction.prototype||s instanceof t.Transaction?le(s,o,{get(){return this.table(o)},set(a){ko(this,o,{value:a,writable:!0,configurable:!0,enumerable:!0})}}):s[o]=new t.Table(o,i))})})}function on({_novip:t},e){e.forEach(r=>{for(let n in r)r[n]instanceof t.Table&&delete r[n]})}function ls(t,e){return t._cfg.version-e._cfg.version}function fs(t,e,r,n){let o=t._dbSchema,i=t._createTransaction("readwrite",t._storeNames,o);i.create(r),i._completion.catch(n);let s=i._reject.bind(i),u=S.transless||S;ge(()=>{S.trans=i,S.transless=u,e===0?(q(o).forEach(a=>{Br(r,a,o[a].primKey,o[a].indexes)}),nn(t,r),k.follow(()=>t.on.populate.fire(i)).catch(s)):function({_novip:a},l,c,f){let p=[],h=a._versions,v=a._dbSchema=an(a,a.idbdb,f),d=!1,b=h.filter(y=>y._cfg.version>=l);function m(){return p.length?k.resolve(p.shift()(c.idbtrans)).then(m):k.resolve()}return b.forEach(y=>{p.push(()=>{let _=v,g=y._cfg.dbschema;un(a,_,f),un(a,g,f),v=a._dbSchema=g;let E=Jo(_,g);E.add.forEach(x=>{Br(f,x[0],x[1].primKey,x[1].indexes)}),E.change.forEach(x=>{if(x.recreate)throw new T.Upgrade("Not yet support for changing primary key");{let A=f.objectStore(x.name);x.add.forEach(w=>sn(A,w)),x.change.forEach(w=>{A.deleteIndex(w.name),sn(A,w)}),x.del.forEach(w=>A.deleteIndex(w))}});let O=y._cfg.contentUpgrade;if(O&&y._cfg.version>l){nn(a,f),c._memoizedTables={},d=!0;let x=Ao(g);E.del.forEach(P=>{x[P]=_[P]}),on(a,[a.Transaction.prototype]),ar(a,[a.Transaction.prototype],q(x),x),c.schema=x;let A=yn(O),w;A&&Ye();let F=k.follow(()=>{if(w=O(c),w&&A){var P=pe.bind(null,null);w.then(P,P)}});return w&&typeof w.then=="function"?k.resolve(w):F.then(()=>w)}}),p.push(_=>{(!d||!ns)&&function(g,E){[].slice.call(E.db.objectStoreNames).forEach(O=>g[O]==null&&E.db.deleteObjectStore(O))}(y._cfg.dbschema,_),on(a,[a.Transaction.prototype]),ar(a,[a.Transaction.prototype],a._storeNames,a._dbSchema),c.schema=a._dbSchema})}),m().then(()=>{var y,_;_=f,q(y=v).forEach(g=>{_.db.objectStoreNames.contains(g)||Br(_,g,y[g].primKey,y[g].indexes)})})}(t,e,i,r).catch(s)})}function Jo(t,e){let r={del:[],add:[],change:[]},n;for(n in t)e[n]||r.del.push(n);for(n in e){let o=t[n],i=e[n];if(o){let s={name:n,def:i,recreate:!1,del:[],add:[],change:[]};if(""+(o.primKey.keyPath||"")!=""+(i.primKey.keyPath||"")||o.primKey.auto!==i.primKey.auto&&!cr)s.recreate=!0,r.change.push(s);else{let u=o.idxByName,a=i.idxByName,l;for(l in u)a[l]||s.del.push(l);for(l in a){let c=u[l],f=a[l];c?c.src!==f.src&&s.change.push(f):s.add.push(f)}(s.del.length>0||s.add.length>0||s.change.length>0)&&r.change.push(s)}}else r.add.push([n,i])}return r}function Br(t,e,r,n){let o=t.db.createObjectStore(e,r.keyPath?{keyPath:r.keyPath,autoIncrement:r.auto}:{autoIncrement:r.auto});return n.forEach(i=>sn(o,i)),o}function sn(t,e){t.createIndex(e.name,e.keyPath,{unique:e.unique,multiEntry:e.multi})}function an(t,e,r){let n={};return er(e.objectStoreNames,0).forEach(o=>{let i=r.objectStore(o),s=i.keyPath,u=tn(Xo(s),s||"",!1,!1,!!i.autoIncrement,s&&typeof s!="string",!0),a=[];for(let c=0;c<i.indexNames.length;++c){let f=i.index(i.indexNames[c]);s=f.keyPath;var l=tn(f.name,s,!!f.unique,!!f.multiEntry,!1,s&&typeof s!="string",!1);a.push(l)}n[o]=Go(o,u,a)}),n}function un({_novip:t},e,r){let n=r.db.objectStoreNames;for(let o=0;o<n.length;++o){let i=n[o],s=r.objectStore(i);t._hasGetAll="getAll"in s;for(let u=0;u<s.indexNames.length;++u){let a=s.indexNames[u],l=s.index(a).keyPath,c=typeof l=="string"?l:"["+er(l).join("+")+"]";if(e[i]){let f=e[i].idxByName[c];f&&(f.name=a,delete e[i].idxByName[c],e[i].idxByName[a]=f)}}}typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&M.WorkerGlobalScope&&M instanceof M.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(t._hasGetAll=!1)}var cn=class{_parseStoresSpec(e,r){q(e).forEach(n=>{if(e[n]!==null){var o=e[n].split(",").map((s,u)=>{let a=(s=s.trim()).replace(/([&*]|\+\+)/g,""),l=/^\[/.test(a)?a.match(/^\[(.*)\]$/)[1].split("+"):a;return tn(a,l||null,/\&/.test(s),/\*/.test(s),/\+\+/.test(s),H(l),u===0)}),i=o.shift();if(i.multi)throw new T.Schema("Primary key cannot be multi-valued");o.forEach(s=>{if(s.auto)throw new T.Schema("Only primary key can be marked as autoIncrement (++)");if(!s.keyPath)throw new T.Schema("Index must have a name and cannot be an empty string")}),r[n]=Go(n,i,o)}})}stores(e){let r=this.db;this._cfg.storesSource=this._cfg.storesSource?z(this._cfg.storesSource,e):e;let n=r._versions,o={},i={};return n.forEach(s=>{z(o,s._cfg.storesSource),i=s._cfg.dbschema={},s._parseStoresSpec(o,i)}),r._dbSchema=i,on(r,[r._allTables,r,r.Transaction.prototype]),ar(r,[r._allTables,r,r.Transaction.prototype,this._cfg.tables],q(i),i),r._storeNames=q(i),this}upgrade(e){return this._cfg.contentUpgrade=gn(this._cfg.contentUpgrade||K,e),this}};function On(t,e){let r=t._dbNamesDB;return r||(r=t._dbNamesDB=new ze(lr,{addons:[],indexedDB:t,IDBKeyRange:e}),r.version(1).stores({dbnames:"name"})),r.table("dbnames")}function En(t){return t&&typeof t.databases=="function"}function ln(t){return ge(function(){return S.letThrough=!0,t()})}function ps(){var t;return!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent)&&indexedDB.databases?new Promise(function(e){var r=function(){return indexedDB.databases().finally(e)};t=setInterval(r,100),r()}).finally(function(){return clearInterval(t)}):Promise.resolve()}function hs(t){let e=t._state,{indexedDB:r}=t._deps;if(e.isBeingOpened||t.idbdb)return e.dbReadyPromise.then(()=>e.dbOpenError?$(e.dbOpenError):t);ne&&(e.openCanceller._stackHolder=Ce()),e.isBeingOpened=!0,e.dbOpenError=null,e.openComplete=!1;let n=e.openCanceller;function o(){if(e.openCanceller!==n)throw new T.DatabaseClosed("db.open() was cancelled")}let i=e.dbReadyResolve,s=null,u=!1;return k.race([n,(typeof navigator>"u"?k.resolve():ps()).then(()=>new k((a,l)=>{if(o(),!r)throw new T.MissingAPI;let c=t.name,f=e.autoSchema?r.open(c):r.open(c,Math.round(10*t.verno));if(!f)throw new T.MissingAPI;f.onerror=re(l),f.onblocked=L(t._fireOnBlocked),f.onupgradeneeded=L(p=>{if(s=f.transaction,e.autoSchema&&!t._options.allowEmptyDB){f.onerror=ft,s.abort(),f.result.close();let v=r.deleteDatabase(c);v.onsuccess=v.onerror=L(()=>{l(new T.NoSuchDatabase(`Database ${c} doesnt exist`))})}else{s.onerror=re(l);var h=p.oldVersion>Math.pow(2,62)?0:p.oldVersion;u=h<1,t._novip.idbdb=f.result,fs(t,h/10,s,l)}},l),f.onsuccess=L(()=>{s=null;let p=t._novip.idbdb=f.result,h=er(p.objectStoreNames);if(h.length>0)try{let d=p.transaction((v=h).length===1?v[0]:v,"readonly");e.autoSchema?function({_novip:b},m,y){b.verno=m.version/10;let _=b._dbSchema=an(0,m,y);b._storeNames=er(m.objectStoreNames,0),ar(b,[b._allTables],q(_),_)}(t,p,d):(un(t,t._dbSchema,d),function(b,m){let y=Jo(an(0,b.idbdb,m),b._dbSchema);return!(y.add.length||y.change.some(_=>_.add.length||_.change.length))}(t,d)||console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Some queries may fail.")),nn(t,d)}catch{}var v;it.push(t),p.onversionchange=L(d=>{e.vcFired=!0,t.on("versionchange").fire(d)}),p.onclose=L(d=>{t.on("close").fire(d)}),u&&function({indexedDB:d,IDBKeyRange:b},m){!En(d)&&m!==lr&&On(d,b).put({name:m}).catch(K)}(t._deps,c),a()},l)}))]).then(()=>(o(),e.onReadyBeingFired=[],k.resolve(ln(()=>t.on.ready.fire(t.vip))).then(function a(){if(e.onReadyBeingFired.length>0){let l=e.onReadyBeingFired.reduce(gn,K);return e.onReadyBeingFired=[],k.resolve(ln(()=>l(t.vip))).then(a)}}))).finally(()=>{e.onReadyBeingFired=null,e.isBeingOpened=!1}).then(()=>t).catch(a=>{e.dbOpenError=a;try{s&&s.abort()}catch{}return n===e.openCanceller&&t._close(),$(a)}).finally(()=>{e.openComplete=!0,i()})}function fn(t){var e=i=>t.next(i),r=o(e),n=o(i=>t.throw(i));function o(i){return s=>{var u=i(s),a=u.value;return u.done?a:a&&typeof a.then=="function"?a.then(r,n):H(a)?Promise.all(a).then(r,n):r(a)}}return o(e)()}function ds(t,e,r){var n=arguments.length;if(n<2)throw new T.InvalidArgument("Too few arguments");for(var o=new Array(n-1);--n;)o[n-1]=arguments[n];return r=o.pop(),[t,jo(o),r]}function Qo(t,e,r,n,o){return k.resolve().then(()=>{let i=S.transless||S,s=t._createTransaction(e,r,t._dbSchema,n),u={trans:s,transless:i};if(n)s.idbtrans=n.idbtrans;else try{s.create(),t._state.PR1398_maxLoop=3}catch(f){return f.name===vn.InvalidState&&t.isOpen()&&--t._state.PR1398_maxLoop>0?(console.warn("Dexie: Need to reopen db"),t._close(),t.open().then(()=>Qo(t,e,r,null,o))):$(f)}let a=yn(o),l;a&&Ye();let c=k.follow(()=>{if(l=o.call(s,s),l)if(a){var f=pe.bind(null,null);l.then(f,f)}else typeof l.next=="function"&&typeof l.throw=="function"&&(l=fn(l))},u);return(l&&typeof l.then=="function"?k.resolve(l).then(f=>s.active?f:$(new T.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))):c.then(()=>l)).then(f=>(n&&s._resolve(),s._completion.then(()=>f))).catch(f=>(s._reject(f),$(f)))})}function Vt(t,e,r){let n=H(t)?t.slice():[t];for(let o=0;o<r;++o)n.push(e);return n}var ms={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:function(t){return{...t,table(e){let r=t.table(e),{schema:n}=r,o={},i=[];function s(c,f,p){let h=at(c),v=o[h]=o[h]||[],d=c==null?0:typeof c=="string"?1:c.length,b=f>0,m={...p,isVirtual:b,keyTail:f,keyLength:d,extractKey:rn(c),unique:!b&&p.unique};return v.push(m),m.isPrimaryKey||i.push(m),d>1&&s(d===2?c[0]:c.slice(0,d-1),f+1,p),v.sort((y,_)=>y.keyTail-_.keyTail),m}let u=s(n.primaryKey.keyPath,0,n.primaryKey);o[":id"]=[u];for(let c of n.indexes)s(c.keyPath,0,c);function a(c){let f=c.query.index;return f.isVirtual?{...c,query:{index:f,range:(p=c.query.range,h=f.keyTail,{type:p.type===1?2:p.type,lower:Vt(p.lower,p.lowerOpen?t.MAX_KEY:t.MIN_KEY,h),lowerOpen:!0,upper:Vt(p.upper,p.upperOpen?t.MIN_KEY:t.MAX_KEY,h),upperOpen:!0})}}:c;var p,h}return{...r,schema:{...n,primaryKey:u,indexes:i,getIndexByKeyPath:function(c){let f=o[at(c)];return f&&f[0]}},count:c=>r.count(a(c)),query:c=>r.query(a(c)),openCursor(c){let{keyTail:f,isVirtual:p,keyLength:h}=c.query.index;return p?r.openCursor(a(c)).then(v=>v&&function(d){return Object.create(d,{continue:{value:function(m){m!=null?d.continue(Vt(m,c.reverse?t.MAX_KEY:t.MIN_KEY,f)):c.unique?d.continue(d.key.slice(0,h).concat(c.reverse?t.MIN_KEY:t.MAX_KEY,f)):d.continue()}},continuePrimaryKey:{value(m,y){d.continuePrimaryKey(Vt(m,t.MAX_KEY,f),y)}},primaryKey:{get:()=>d.primaryKey},key:{get(){let m=d.key;return h===1?m[0]:m.slice(0,h)}},value:{get:()=>d.value}})}(v)):r.openCursor(c)}}}}}};function kn(t,e,r,n){return r=r||{},n=n||"",q(t).forEach(o=>{if(J(e,o)){var i=t[o],s=e[o];if(typeof i=="object"&&typeof s=="object"&&i&&s){let u=Nr(i);u!==Nr(s)?r[n+o]=e[o]:u==="Object"?kn(i,s,r,n+o+"."):i!==s&&(r[n+o]=e[o])}else i!==s&&(r[n+o]=e[o])}else r[n+o]=void 0}),q(e).forEach(o=>{J(t,o)||(r[n+o]=e[o])}),r}var ys={stack:"dbcore",name:"HooksMiddleware",level:2,create:t=>({...t,table(e){let r=t.table(e),{primaryKey:n}=r.schema;return{...r,mutate(i){let s=S.trans,{deleting:u,creating:a,updating:l}=s.table(e).hook;switch(i.type){case"add":if(a.fire===K)break;return s._promise("readwrite",()=>c(i),!0);case"put":if(a.fire===K&&l.fire===K)break;return s._promise("readwrite",()=>c(i),!0);case"delete":if(u.fire===K)break;return s._promise("readwrite",()=>c(i),!0);case"deleteRange":if(u.fire===K)break;return s._promise("readwrite",()=>function(p){return f(p.trans,p.range,1e4)}(i),!0)}return r.mutate(i);function c(p){let h=S.trans,v=p.keys||function(d,b){return b.type==="delete"?b.keys:b.keys||b.values.map(d.extractKey)}(n,p);if(!v)throw new Error("Keys missing");return(p=p.type==="add"||p.type==="put"?{...p,keys:v}:{...p}).type!=="delete"&&(p.values=[...p.values]),p.keys&&(p.keys=[...p.keys]),function(d,b,m){return b.type==="add"?Promise.resolve([]):d.getMany({trans:b.trans,keys:m,cache:"immutable"})}(r,p,v).then(d=>{let b=v.map((m,y)=>{let _=d[y],g={onerror:null,onsuccess:null};if(p.type==="delete")u.fire.call(g,m,_,h);else if(p.type==="add"||_===void 0){let E=a.fire.call(g,m,p.values[y],h);m==null&&E!=null&&(m=E,p.keys[y]=m,n.outbound||Z(p.values[y],n.keyPath,m))}else{let E=kn(_,p.values[y]),O=l.fire.call(g,E,m,_,h);if(O){let x=p.values[y];Object.keys(O).forEach(A=>{J(x,A)?x[A]=O[A]:Z(x,A,O[A])})}}return g});return r.mutate(p).then(({failures:m,results:y,numFailures:_,lastResult:g})=>{for(let E=0;E<v.length;++E){let O=y?y[E]:v[E],x=b[E];O==null?x.onerror&&x.onerror(m[E]):x.onsuccess&&x.onsuccess(p.type==="put"&&d[E]?p.values[E]:O)}return{failures:m,results:y,numFailures:_,lastResult:g}}).catch(m=>(b.forEach(y=>y.onerror&&y.onerror(m)),Promise.reject(m)))})}function f(p,h,v){return r.query({trans:p,values:!1,query:{index:n,range:h},limit:v}).then(({result:d})=>c({type:"delete",keys:d,trans:p}).then(b=>b.numFailures>0?Promise.reject(b.failures[0]):d.length<v?{failures:[],numFailures:0,lastResult:void 0}:f(p,{...h,lower:d[d.length-1],lowerOpen:!0},v)))}}}}})};function Zo(t,e,r){try{if(!e||e.keys.length<t.length)return null;let n=[];for(let o=0,i=0;o<e.keys.length&&i<t.length;++o)V(e.keys[o],t[i])===0&&(n.push(r?mt(e.values[o]):e.values[o]),++i);return n.length===t.length?n:null}catch{return null}}var bs={stack:"dbcore",level:-1,create:t=>({table:e=>{let r=t.table(e);return{...r,getMany:n=>{if(!n.cache)return r.getMany(n);let o=Zo(n.keys,n.trans._cache,n.cache==="clone");return o?k.resolve(o):r.getMany(n).then(i=>(n.trans._cache={keys:n.keys,values:n.cache==="clone"?mt(i):i},i))},mutate:n=>(n.type!=="add"&&(n.trans._cache=null),r.mutate(n))}}})};function Sn(t){return!("from"in t)}var ae=function(t,e){if(!this){let r=new ae;return t&&"d"in t&&z(r,t),r}z(this,arguments.length?{d:1,from:t,to:arguments.length>1?e:t}:{d:0})};function dt(t,e,r){let n=V(e,r);if(isNaN(n))return;if(n>0)throw RangeError();if(Sn(t))return z(t,{from:e,to:r,d:1});let o=t.l,i=t.r;if(V(r,t.from)<0)return o?dt(o,e,r):t.l={from:e,to:r,d:1,l:null,r:null},Oo(t);if(V(e,t.to)>0)return i?dt(i,e,r):t.r={from:e,to:r,d:1,l:null,r:null},Oo(t);V(e,t.from)<0&&(t.from=e,t.l=null,t.d=i?i.d+1:1),V(r,t.to)>0&&(t.to=r,t.r=null,t.d=t.l?t.l.d+1:1);let s=!t.r;o&&!t.l&&ur(t,o),i&&s&&ur(t,i)}function ur(t,e){Sn(e)||function r(n,{from:o,to:i,l:s,r:u}){dt(n,o,i),s&&r(n,s),u&&r(n,u)}(t,e)}function vs(t,e){let r=pn(e),n=r.next();if(n.done)return!1;let o=n.value,i=pn(t),s=i.next(o.from),u=s.value;for(;!n.done&&!s.done;){if(V(u.from,o.to)<=0&&V(u.to,o.from)>=0)return!0;V(o.from,u.from)<0?o=(n=r.next(u.from)).value:u=(s=i.next(o.from)).value}return!1}function pn(t){let e=Sn(t)?null:{s:0,n:t};return{next(r){let n=arguments.length>0;for(;e;)switch(e.s){case 0:if(e.s=1,n)for(;e.n.l&&V(r,e.n.from)<0;)e={up:e,n:e.n.l,s:1};else for(;e.n.l;)e={up:e,n:e.n.l,s:1};case 1:if(e.s=2,!n||V(r,e.n.to)<=0)return{value:e.n,done:!1};case 2:if(e.n.r){e.s=3,e={up:e,n:e.n.r,s:0};continue}case 3:e=e.up}return{done:!0}}}}function Oo(t){var e,r;let n=(((e=t.r)===null||e===void 0?void 0:e.d)||0)-(((r=t.l)===null||r===void 0?void 0:r.d)||0),o=n>1?"r":n<-1?"l":"";if(o){let i=o==="r"?"l":"r",s={...t},u=t[o];t.from=u.from,t.to=u.to,t[o]=u[o],s[o]=u[i],t[i]=s,s.d=Eo(s)}t.d=Eo(t)}function Eo({r:t,l:e}){return(t?e?Math.max(t.d,e.d):t.d:e?e.d:0)+1}Ve(ae.prototype,{add(t){return ur(this,t),this},addKey(t){return dt(this,t,t),this},addKeys(t){return t.forEach(e=>dt(this,e,e)),this},[Lr](){return pn(this)}});var gs={stack:"dbcore",level:0,create:t=>{let e=t.schema.name,r=new ae(t.MIN_KEY,t.MAX_KEY);return{...t,table:n=>{let o=t.table(n),{schema:i}=o,{primaryKey:s}=i,{extractKey:u,outbound:a}=s,l={...o,mutate:p=>{let h=p.trans,v=h.mutatedParts||(h.mutatedParts={}),d=O=>{let x=`idb://${e}/${n}/${O}`;return v[x]||(v[x]=new ae)},b=d(""),m=d(":dels"),{type:y}=p,[_,g]=p.type==="deleteRange"?[p.range]:p.type==="delete"?[p.keys]:p.values.length<50?[[],p.values]:[],E=p.trans._cache;return o.mutate(p).then(O=>{if(H(_)){y!=="delete"&&(_=O.results),b.addKeys(_);let x=Zo(_,E);x||y==="add"||m.addKeys(_),(x||g)&&function(A,w,F,P){function R(I){let C=A(I.name||"");function oe(Y){return Y!=null?I.extractKey(Y):null}let he=Y=>I.multiEntry&&H(Y)?Y.forEach(we=>C.addKey(we)):C.addKey(Y);(F||P).forEach((Y,we)=>{let Ge=F&&oe(F[we]),fr=P&&oe(P[we]);V(Ge,fr)!==0&&(Ge!=null&&he(Ge),fr!=null&&he(fr))})}w.indexes.forEach(R)}(d,i,x,g)}else if(_){let x={from:_.lower,to:_.upper};m.add(x),b.add(x)}else b.add(r),m.add(r),i.indexes.forEach(x=>d(x.name).add(r));return O})}},c=({query:{index:p,range:h}})=>{var v,d;return[p,new ae((v=h.lower)!==null&&v!==void 0?v:t.MIN_KEY,(d=h.upper)!==null&&d!==void 0?d:t.MAX_KEY)]},f={get:p=>[s,new ae(p.key)],getMany:p=>[s,new ae().addKeys(p.keys)],count:c,query:c,openCursor:c};return q(f).forEach(p=>{l[p]=function(h){let{subscr:v}=S;if(v){let d=g=>{let E=`idb://${e}/${n}/${g}`;return v[E]||(v[E]=new ae)},b=d(""),m=d(":dels"),[y,_]=f[p](h);if(d(y.name||"").add(_),!y.isPrimaryKey){if(p!=="count"){let g=p==="query"&&a&&h.values&&o.query({...h,values:!1});return o[p].apply(this,arguments).then(E=>{if(p==="query"){if(a&&h.values)return g.then(({result:x})=>(b.addKeys(x),E));let O=h.values?E.result.map(u):E.result;h.values?b.addKeys(O):m.addKeys(O)}else if(p==="openCursor"){let O=E,x=h.values;return O&&Object.create(O,{key:{get:()=>(m.addKey(O.primaryKey),O.key)},primaryKey:{get(){let A=O.primaryKey;return m.addKey(A),A}},value:{get:()=>(x&&b.addKey(O.primaryKey),O.value)}})}return E})}m.add(r)}}return o[p].apply(this,arguments)}}),l}}}},ze=class t{constructor(e,r){this._middlewares={},this.verno=0;let n=t.dependencies;this._options=r={addons:t.addons,autoOpen:!0,indexedDB:n.indexedDB,IDBKeyRange:n.IDBKeyRange,...r},this._deps={indexedDB:r.indexedDB,IDBKeyRange:r.IDBKeyRange};let{addons:o}=r;this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this;let i={dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:K,dbReadyPromise:null,cancelOpen:K,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3};var s;i.dbReadyPromise=new k(u=>{i.dbReadyResolve=u}),i.openCanceller=new k((u,a)=>{i.cancelOpen=a}),this._state=i,this.name=e,this.on=st(this,"populate","blocked","versionchange","close",{ready:[gn,K]}),this.on.ready.subscribe=So(this.on.ready.subscribe,u=>(a,l)=>{t.vip(()=>{let c=this._state;if(c.openComplete)c.dbOpenError||k.resolve().then(a),l&&u(a);else if(c.onReadyBeingFired)c.onReadyBeingFired.push(a),l&&u(a);else{u(a);let f=this;l||u(function p(){f.on.ready.unsubscribe(a),f.on.ready.unsubscribe(p)})}})}),this.Collection=(s=this,et(Zr.prototype,function(u,a){this.db=s;let l=zo,c=null;if(a)try{l=a()}catch(v){c=v}let f=u._ctx,p=f.table,h=p.hook.reading.fire;this._ctx={table:p,index:f.index,isPrimKey:!f.index||p.schema.primKey.keyPath&&f.index===p.schema.primKey.name,range:l,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:c,or:f.or,valueMapper:h!==ct?h:null}})),this.Table=function(u){return et(Qr.prototype,function(a,l,c){this.db=u,this._tx=c,this.name=a,this.schema=l,this.hook=u._allTables[a]?u._allTables[a].hook:st(null,{creating:[zi,K],reading:[Vi,ct],updating:[Xi,K],deleting:[Yi,K]})})}(this),this.Transaction=function(u){return et(en.prototype,function(a,l,c,f,p){this.db=u,this.mode=a,this.storeNames=l,this.schema=c,this.chromeTransactionDurability=f,this.idbtrans=null,this.on=st(this,"complete","error","abort"),this.parent=p||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new k((h,v)=>{this._resolve=h,this._reject=v}),this._completion.then(()=>{this.active=!1,this.on.complete.fire()},h=>{var v=this.active;return this.active=!1,this.on.error.fire(h),this.parent?this.parent._reject(h):v&&this.idbtrans&&this.idbtrans.abort(),$(h)})})}(this),this.Version=function(u){return et(cn.prototype,function(a){this.db=u,this._cfg={version:a,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}})}(this),this.WhereClause=function(u){return et(sr.prototype,function(a,l,c){this.db=u,this._ctx={table:a,index:l===":id"?null:l,or:c};let f=u._deps.indexedDB;if(!f)throw new T.MissingAPI;this._cmp=this._ascending=f.cmp.bind(f),this._descending=(p,h)=>f.cmp(h,p),this._max=(p,h)=>f.cmp(p,h)>0?p:h,this._min=(p,h)=>f.cmp(p,h)<0?p:h,this._IDBKeyRange=u._deps.IDBKeyRange})}(this),this.on("versionchange",u=>{u.newVersion>0?console.warn(`Another connection wants to upgrade database '${this.name}'. Closing db now to resume the upgrade.`):console.warn(`Another connection wants to delete database '${this.name}'. Closing db now to resume the delete request.`),this.close()}),this.on("blocked",u=>{!u.newVersion||u.newVersion<u.oldVersion?console.warn(`Dexie.delete('${this.name}') was blocked`):console.warn(`Upgrade '${this.name}' blocked by other connection holding version ${u.oldVersion/10}`)}),this._maxKey=ht(r.IDBKeyRange),this._createTransaction=(u,a,l,c)=>new this.Transaction(u,a,l,this._options.chromeTransactionDurability,c),this._fireOnBlocked=u=>{this.on("blocked").fire(u),it.filter(a=>a.name===this.name&&a!==this&&!a._state.vcFired).map(a=>a.on("versionchange").fire(u))},this.use(ms),this.use(ys),this.use(gs),this.use(bs),this.vip=Object.create(this,{_vip:{value:!0}}),o.forEach(u=>u(this))}version(e){if(isNaN(e)||e<.1)throw new T.Type("Given version is not a positive number");if(e=Math.round(10*e)/10,this.idbdb||this._state.isBeingOpened)throw new T.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,e);let r=this._versions;var n=r.filter(o=>o._cfg.version===e)[0];return n||(n=new this.Version(e),r.push(n),r.sort(ls),n.stores({}),this._state.autoSchema=!1,n)}_whenReady(e){return this.idbdb&&(this._state.openComplete||S.letThrough||this._vip)?e():new k((r,n)=>{if(this._state.openComplete)return n(new T.DatabaseClosed(this._state.dbOpenError));if(!this._state.isBeingOpened){if(!this._options.autoOpen)return void n(new T.DatabaseClosed);this.open().catch(K)}this._state.dbReadyPromise.then(r,n)}).then(e)}use({stack:e,create:r,level:n,name:o}){o&&this.unuse({stack:e,name:o});let i=this._middlewares[e]||(this._middlewares[e]=[]);return i.push({stack:e,create:r,level:n??10,name:o}),i.sort((s,u)=>s.level-u.level),this}unuse({stack:e,name:r,create:n}){return e&&this._middlewares[e]&&(this._middlewares[e]=this._middlewares[e].filter(o=>n?o.create!==n:!!r&&o.name!==r)),this}open(){return hs(this)}_close(){let e=this._state,r=it.indexOf(this);if(r>=0&&it.splice(r,1),this.idbdb){try{this.idbdb.close()}catch{}this._novip.idbdb=null}e.dbReadyPromise=new k(n=>{e.dbReadyResolve=n}),e.openCanceller=new k((n,o)=>{e.cancelOpen=o})}close(){this._close();let e=this._state;this._options.autoOpen=!1,e.dbOpenError=new T.DatabaseClosed,e.isBeingOpened&&e.cancelOpen(e.dbOpenError)}delete(){let e=arguments.length>0,r=this._state;return new k((n,o)=>{let i=()=>{this.close();var s=this._deps.indexedDB.deleteDatabase(this.name);s.onsuccess=L(()=>{(function({indexedDB:u,IDBKeyRange:a},l){!En(u)&&l!==lr&&On(u,a).delete(l).catch(K)})(this._deps,this.name),n()}),s.onerror=re(o),s.onblocked=this._fireOnBlocked};if(e)throw new T.InvalidArgument("Arguments not allowed in db.delete()");r.isBeingOpened?r.dbReadyPromise.then(i):i()})}backendDB(){return this.idbdb}isOpen(){return this.idbdb!==null}hasBeenClosed(){let e=this._state.dbOpenError;return e&&e.name==="DatabaseClosed"}hasFailed(){return this._state.dbOpenError!==null}dynamicallyOpened(){return this._state.autoSchema}get tables(){return q(this._allTables).map(e=>this._allTables[e])}transaction(){let e=ds.apply(this,arguments);return this._transaction.apply(this,e)}_transaction(e,r,n){let o=S.trans;o&&o.db===this&&e.indexOf("!")===-1||(o=null);let i=e.indexOf("?")!==-1,s,u;e=e.replace("!","").replace("?","");try{if(u=r.map(l=>{var c=l instanceof this.Table?l.name:l;if(typeof c!="string")throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return c}),e=="r"||e===Ir)s=Ir;else{if(e!="rw"&&e!=Cr)throw new T.InvalidArgument("Invalid transaction mode: "+e);s=Cr}if(o){if(o.mode===Ir&&s===Cr){if(!i)throw new T.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");o=null}o&&u.forEach(l=>{if(o&&o.storeNames.indexOf(l)===-1){if(!i)throw new T.SubTransaction("Table "+l+" not included in parent transaction.");o=null}}),i&&o&&!o.active&&(o=null)}}catch(l){return o?o._promise(null,(c,f)=>{f(l)}):$(l)}let a=Qo.bind(null,this,s,u,o,n);return o?o._promise(s,a,"lock"):S.trans?Xe(S.transless,()=>this._whenReady(a)):this._whenReady(a)}table(e){if(!J(this._allTables,e))throw new T.InvalidTable(`Table ${e} does not exist`);return this._allTables[e]}},xs=typeof Symbol<"u"&&"observable"in Symbol?Symbol.observable:"@@observable",hn=class{constructor(e){this._subscribe=e}subscribe(e,r,n){return this._subscribe(e&&typeof e!="function"?e:{next:e,error:r,complete:n})}[xs](){return this}};function ei(t,e){return q(e).forEach(r=>{ur(t[r]||(t[r]=new ae),e[r])}),t}function Pn(t){let e,r=!1,n=new hn(o=>{let i=yn(t),s=!1,u={},a={},l={get closed(){return s},unsubscribe:()=>{s=!0,_e.storagemutated.unsubscribe(h)}};o.start&&o.start(l);let c=!1,f=!1;function p(){return q(a).some(d=>u[d]&&vs(u[d],a[d]))}let h=d=>{ei(u,d),p()&&v()},v=()=>{if(c||s)return;u={};let d={},b=function(m){i&&Ye();let y=()=>ge(t,{subscr:m,trans:null}),_=S.trans?Xe(S.transless,y):y();return i&&_.then(pe,pe),_}(d);f||(_e(pt,h),f=!0),c=!0,Promise.resolve(b).then(m=>{r=!0,e=m,c=!1,s||(p()?v():(u={},a=d,o.next&&o.next(m)))},m=>{c=!1,r=!1,o.error&&o.error(m),l.unsubscribe()})};return v(),l});return n.hasValue=()=>r,n.getValue=()=>e,n}var dn;try{dn={indexedDB:M.indexedDB||M.mozIndexedDB||M.webkitIndexedDB||M.msIndexedDB,IDBKeyRange:M.IDBKeyRange||M.webkitIDBKeyRange}}catch{dn={indexedDB:null,IDBKeyRange:null}}var Pe=ze;function Zt(t){let e=ce;try{ce=!0,_e.storagemutated.fire(t)}finally{ce=e}}Ve(Pe,{...zt,delete:t=>new Pe(t,{addons:[]}).delete(),exists:t=>new Pe(t,{addons:[]}).open().then(e=>(e.close(),!0)).catch("NoSuchDatabaseError",()=>!1),getDatabaseNames(t){try{return function({indexedDB:e,IDBKeyRange:r}){return En(e)?Promise.resolve(e.databases()).then(n=>n.map(o=>o.name).filter(o=>o!==lr)):On(e,r).toCollection().primaryKeys()}(Pe.dependencies).then(t)}catch{return $(new T.MissingAPI)}},defineClass:()=>function(t){z(this,t)},ignoreTransaction:t=>S.trans?Xe(S.transless,t):t(),vip:ln,async:function(t){return function(){try{var e=fn(t.apply(this,arguments));return e&&typeof e.then=="function"?e:k.resolve(e)}catch(r){return $(r)}}},spawn:function(t,e,r){try{var n=fn(t.apply(r,e||[]));return n&&typeof n.then=="function"?n:k.resolve(n)}catch(o){return $(o)}},currentTransaction:{get:()=>S.trans||null},waitFor:function(t,e){let r=k.resolve(typeof t=="function"?Pe.ignoreTransaction(t):t).timeout(e||6e4);return S.trans?S.trans.waitFor(r):r},Promise:k,debug:{get:()=>ne,set:t=>{Io(t,t==="dexie"?()=>!0:Vo)}},derive:Ue,extend:z,props:Ve,override:So,Events:st,on:_e,liveQuery:Pn,extendObservabilitySet:ei,getByKeyPath:fe,setByKeyPath:Z,delByKeyPath:function(t,e){typeof e=="string"?Z(t,e,void 0):"length"in e&&[].map.call(e,function(r){Z(t,r,void 0)})},shallowClone:Ao,deepClone:mt,getObjectDiff:kn,cmp:V,asap:Po,minKey:Jr,addons:[],connections:it,errnames:vn,dependencies:dn,semVer:bo,version:bo.split(".").map(t=>parseInt(t)).reduce((t,e,r)=>t+e/Math.pow(10,2*r))}),Pe.maxKey=ht(Pe.dependencies.IDBKeyRange),typeof dispatchEvent<"u"&&typeof addEventListener<"u"&&(_e(pt,t=>{if(!ce){let e;cr?(e=document.createEvent("CustomEvent"),e.initCustomEvent(ve,!0,!0,t)):e=new CustomEvent(ve,{detail:t}),ce=!0,dispatchEvent(e),ce=!1}}),addEventListener(ve,({detail:t})=>{ce||Zt(t)}));var ce=!1;if(typeof BroadcastChannel<"u"){let t=new BroadcastChannel(ve);typeof t.unref=="function"&&t.unref(),_e(pt,e=>{ce||t.postMessage(e)}),t.onmessage=e=>{e.data&&Zt(e.data)}}else if(typeof self<"u"&&typeof navigator<"u"){_e(pt,e=>{try{ce||(typeof localStorage<"u"&&localStorage.setItem(ve,JSON.stringify({trig:Math.random(),changedParts:e})),typeof self.clients=="object"&&[...self.clients.matchAll({includeUncontrolled:!0})].forEach(r=>r.postMessage({type:ve,changedParts:e})))}catch{}}),typeof addEventListener<"u"&&addEventListener("storage",e=>{if(e.key===ve){let r=JSON.parse(e.newValue);r&&Zt(r.changedParts)}});let t=self.document&&navigator.serviceWorker;t&&t.addEventListener("message",function({data:e}){e&&e.type===ve&&Zt(e.changedParts)})}k.rejectionMapper=function(t,e){if(!t||t instanceof We||t instanceof TypeError||t instanceof SyntaxError||!t.name||!po[t.name])return t;var r=new po[t.name](e||t.message,t);return"stack"in t&&le(r,"stack",{get:function(){return this.inner.stack}}),r},Io(ne,Vo);var Tn=class extends ze{constructor(){super("ngdexieliveQuery"),this.version(3).stores({words:"++,fr,value"}),this.on("populate",()=>this.populate())}populate(){console.log("populate")}},An=new Tn;var _s=[0,1];addEventListener("message",({data:t})=>{if(_s.find(e=>e===t)===void 0)return postMessage(`5 LOGIC_ERROR: ${t}`);Rn.pipe(Qe(jn)).subscribe({next:e=>{postMessage(`0 ${e[1]} ${e[0]}`)},error:e=>postMessage(`5 ${e}`)}),Rn.pipe(Qe(jn),te(([e,r])=>Es(e,r))).subscribe({next:e=>{postMessage(`2 ${e} %`)},error:e=>postMessage(`5 ${e}`)}),t===1&&Rn.pipe(Qe(jn),Er(1),Ft(([e,r])=>r<e?(postMessage("1"),Os(r).pipe(Bt(n=>postMessage(`2 ${n} mots`)))):gr(100))).subscribe({complete:()=>postMessage("3"),error:e=>postMessage(`5 ${e}`)})});var ws=me({url:"/assets/dictionnaries/fr/ods6.txt",headers:{Accept:"text"},responseType:"text"}),jn=Pn(()=>An.words.count()),ti=ws.pipe(Ft(t=>de(t.response.split(/\n/))),kr(),te(t=>({lang:0,value:t})),Pr()),Rn=ti.pipe(Or()),Os=(t=0)=>ti.pipe(xr((e,r)=>r>=t),_r(5e4),Dt(e=>de(An.words.bulkAdd(e))),Bt(e=>console.log("count",e))),Es=(t,e)=>e?(e/t*100).toFixed(0):0;
